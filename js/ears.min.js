(function(c, d, f, l, x, U) {
  function E(a, b) {
    var e = typeof a[b];
    return"function" == e || !!("object" == e && a[b]) || "unknown" == e
  }
  function V() {
    if(!y(navigator.plugins) && "object" == typeof navigator.plugins["Shockwave Flash"]) {
      var a = navigator.plugins["Shockwave Flash"].description;
      a && (!y(navigator.mimeTypes) && navigator.mimeTypes["application/x-shockwave-flash"] && navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin) && (B = a.match(/\d+/g))
    }
    if(!B) {
      var b;
      try {
        b = new ActiveXObject("ShockwaveFlash.ShockwaveFlash"), B = Array.prototype.slice.call(b.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/), 1)
      }catch(e) {
      }
    }
    if(!B) {
      return!1
    }
    a = parseInt(B[0], 10);
    b = parseInt(B[1], 10);
    R = 9 < a && 0 < b;
    return!0
  }
  function K() {
    if(!C) {
      C = !0;
      for(var a = 0;a < L.length;a++) {
        L[a]()
      }
      L.length = 0
    }
  }
  function D(a, b) {
    C ? a.call(b) : L.push(function() {
      a.call(b)
    })
  }
  function ba() {
    var a = parent;
    if("" !== H) {
      for(var b = 0, e = H.split(".");b < e.length;b++) {
        a = a[e[b]]
      }
    }
    return a.easyXDM
  }
  function r(a) {
    var b = a.toLowerCase().match(M);
    a = b[2];
    var e = b[3], b = b[4] || "";
    if("http:" == a && ":80" == b || "https:" == a && ":443" == b) {
      b = ""
    }
    return a + "//" + e + b
  }
  function I(a) {
    a = a.replace(ca, "$1/");
    if(!a.match(/^(http||https):\/\//)) {
      var b = "/" === a.substring(0, 1) ? "" : f.pathname;
      "/" !== b.substring(b.length - 1) && (b = b.substring(0, b.lastIndexOf("/") + 1));
      a = f.protocol + "//" + f.host + b + a
    }
    for(;W.test(a);) {
      a = a.replace(W, "")
    }
    return a
  }
  function F(a, b) {
    var e = "", h = a.indexOf("#");
    -1 !== h && (e = a.substring(h), a = a.substring(0, h));
    var h = [], c;
    for(c in b) {
      b.hasOwnProperty(c) && h.push(c + "\x3d" + U(b[c]))
    }
    return a + (X ? "#" : -1 == a.indexOf("?") ? "?" : "\x26") + h.join("\x26") + e
  }
  function y(a) {
    return"undefined" === typeof a
  }
  function s(a, b, e) {
    var h, c;
    for(c in b) {
      b.hasOwnProperty(c) && (c in a ? (h = b[c], "object" === typeof h ? s(a[c], h, e) : e || (a[c] = b[c])) : a[c] = b[c])
    }
    return a
  }
  function A(a) {
    if(y(N)) {
      var b = d.body.appendChild(d.createElement("form")), e = b.appendChild(d.createElement("input"));
      e.name = v + "TEST" + Y;
      N = e !== b.elements[e.name];
      d.body.removeChild(b)
    }
    N ? b = d.createElement('\x3ciframe name\x3d"' + a.props.name + '"/\x3e') : (b = d.createElement("IFRAME"), b.name = a.props.name);
    b.id = b.name = a.props.name;
    delete a.props.name;
    "string" == typeof a.container && (a.container = d.getElementById(a.container));
    a.container || (s(b.style, {position:"absolute", top:"-2000px", left:"0px"}), a.container = d.body);
    e = a.props.src;
    a.props.src = "javascript:false";
    s(b, a.props);
    b.border = b.frameBorder = 0;
    b.allowTransparency = !0;
    a.container.appendChild(b);
    a.onLoad && w(b, "load", a.onLoad);
    if(a.usePost) {
      var h = a.container.appendChild(d.createElement("form")), c;
      h.target = b.name;
      h.action = e;
      h.method = "POST";
      if("object" === typeof a.usePost) {
        for(var k in a.usePost) {
          a.usePost.hasOwnProperty(k) && (N ? c = d.createElement('\x3cinput name\x3d"' + k + '"/\x3e') : (c = d.createElement("INPUT"), c.name = k), c.value = a.usePost[k], h.appendChild(c))
        }
      }
      h.submit();
      h.parentNode.removeChild(h)
    }else {
      b.src = e
    }
    a.props.src = e;
    return b
  }
  function Z(a) {
    var b = a.protocol, e;
    a.isHost = a.isHost || y(t.xdm_p);
    X = a.hash || !1;
    a.props || (a.props = {});
    if(a.isHost) {
      a.remote = I(a.remote), a.channel = a.channel || "default" + Y++, a.secret = Math.random().toString(16).substring(2), y(b) && (b = r(f.href) == r(a.remote) ? "4" : E(c, "postMessage") || E(d, "postMessage") ? "1" : a.swf && E(c, "ActiveXObject") && V() ? "6" : "Gecko" === navigator.product && "frameElement" in c && -1 == navigator.userAgent.indexOf("WebKit") ? "5" : a.remoteHelper ? "2" : "0")
    }else {
      a.channel = t.xdm_c.replace(/["'<>\\]/g, "");
      a.secret = t.xdm_s;
      a.remote = t.xdm_e.replace(/["'<>\\]/g, "");
      var b = t.xdm_p, h;
      if(h = a.acl) {
        a: {
          h = a.acl;
          var u = a.remote;
          "string" == typeof h && (h = [h]);
          for(var k, p = h.length;p--;) {
            if(k = h[p], k = RegExp("^" == k.substr(0, 1) ? k : "^" + k.replace(/(\*)/g, ".$1").replace(/\?/g, ".") + "$"), k.test(u)) {
              h = !0;
              break a
            }
          }
          h = !1
        }
        h = !h
      }
      if(h) {
        throw Error("Access denied for " + a.remote);
      }
    }
    a.protocol = b;
    switch(b) {
      case "0":
        s(a, {interval:100, delay:2E3, useResize:!0, useParent:!1, usePolling:!1}, !0);
        if(a.isHost) {
          if(!a.local) {
            b = f.protocol + "//" + f.host;
            e = d.body.getElementsByTagName("img");
            for(u = e.length;u--;) {
              if(h = e[u], h.src.substring(0, b.length) === b) {
                a.local = h.src;
                break
              }
            }
            a.local || (a.local = c)
          }
          b = {xdm_c:a.channel, xdm_p:0};
          a.local === c ? (a.usePolling = !0, a.useParent = !0, a.local = f.protocol + "//" + f.host + f.pathname + f.search, b.xdm_e = a.local, b.xdm_pa = 1) : b.xdm_e = I(a.local);
          a.container && (a.useResize = !1, b.xdm_po = 1);
          a.remote = F(a.remote, b)
        }else {
          s(a, {channel:t.xdm_c, remote:t.xdm_e, useParent:!y(t.xdm_pa), usePolling:!y(t.xdm_po), useResize:a.useParent ? !1 : a.useResize})
        }
        e = [new g.stack.HashTransport(a), new g.stack.ReliableBehavior({}), new g.stack.QueueBehavior({encode:!0, maxLength:4E3 - a.remote.length}), new g.stack.VerifyBehavior({initiate:a.isHost})];
        break;
      case "1":
        e = [new g.stack.PostMessageTransport(a)];
        break;
      case "2":
        a.remoteHelper = I(a.remoteHelper);
        e = [new g.stack.NameTransport(a), new g.stack.QueueBehavior, new g.stack.VerifyBehavior({initiate:a.isHost})];
        break;
      case "3":
        e = [new g.stack.NixTransport(a)];
        break;
      case "4":
        e = [new g.stack.SameOriginTransport(a)];
        break;
      case "5":
        e = [new g.stack.FrameElementTransport(a)];
        break;
      case "6":
        B || V(), e = [new g.stack.FlashTransport(a)]
    }
    e.push(new g.stack.QueueBehavior({lazy:a.lazy, remove:!0}));
    return e
  }
  function $(a) {
    for(var b, e = {incoming:function(a, b) {
      this.up.incoming(a, b)
    }, outgoing:function(a, b) {
      this.down.outgoing(a, b)
    }, callback:function(a) {
      this.up.callback(a)
    }, init:function() {
      this.down.init()
    }, destroy:function() {
      this.down.destroy()
    }}, h = 0, c = a.length;h < c;h++) {
      b = a[h], s(b, e, !0), 0 !== h && (b.down = a[h - 1]), h !== c - 1 && (b.up = a[h + 1])
    }
    return b
  }
  function da(a) {
    a.up.down = a.down;
    a.down.up = a.up;
    a.up = a.down = null
  }
  var O = this, Y = Math.floor(1E4 * Math.random()), S = Function.prototype, M = /^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/, W = /[\-\w]+\/\.\.\//, ca = /([^:])\/\//g, H = "", g = {}, ea = c.easyXDM, v = "easyXDM_", N, X = !1, B, R, w, G;
  if(E(c, "addEventListener")) {
    w = function(a, b, e) {
      a.addEventListener(b, e, !1)
    }, G = function(a, b, e) {
      a.removeEventListener(b, e, !1)
    }
  }else {
    if(E(c, "attachEvent")) {
      w = function(a, b, e) {
        a.attachEvent("on" + b, e)
      }, G = function(a, b, e) {
        a.detachEvent("on" + b, e)
      }
    }else {
      throw Error("Browser not supported");
    }
  }
  var C = !1, L = [], P;
  "readyState" in d ? (P = d.readyState, C = "complete" == P || ~navigator.userAgent.indexOf("AppleWebKit/") && ("loaded" == P || "interactive" == P)) : C = !!d.body;
  if(!C) {
    if(E(c, "addEventListener")) {
      w(d, "DOMContentLoaded", K)
    }else {
      if(w(d, "readystatechange", function() {
        "complete" == d.readyState && K()
      }), d.documentElement.doScroll && c === top) {
        var aa = function() {
          if(!C) {
            try {
              d.documentElement.doScroll("left")
            }catch(a) {
              l(aa, 1);
              return
            }
            K()
          }
        };
        aa()
      }
    }
    w(c, "load", K)
  }
  var t = function(a) {
    a = a.substring(1).split("\x26");
    for(var b = {}, e, c = a.length;c--;) {
      e = a[c].split("\x3d"), b[e[0]] = x(e[1])
    }
    return b
  }(/xdm_e=/.test(f.search) ? f.search : f.hash), T = function() {
    var a = {}, b = {a:[1, 2, 3]};
    if("undefined" != typeof JSON && "function" === typeof JSON.stringify && '{"a":[1,2,3]}' === JSON.stringify(b).replace(/\s/g, "")) {
      return JSON
    }
    Object.toJSON && '{"a":[1,2,3]}' === Object.toJSON(b).replace(/\s/g, "") && (a.stringify = Object.toJSON);
    "function" === typeof String.prototype.evalJSON && (b = '{"a":[1,2,3]}'.evalJSON(), b.a && (3 === b.a.length && 3 === b.a[2]) && (a.parse = function(a) {
      return a.evalJSON()
    }));
    return a.stringify && a.parse ? (T = function() {
      return a
    }, a) : null
  };
  s(g, {version:"2.4.17.1", query:t, stack:{}, apply:s, getJSONObject:T, whenReady:D, noConflict:function(a) {
    c.easyXDM = ea;
    (H = a) && (v = "easyXDM_" + H.replace(".", "_") + "_");
    return g
  }});
  g.DomHelper = {on:w, un:G, requiresJSON:function(a) {
    "object" == typeof c.JSON && c.JSON || d.write('\x3cscript type\x3d"text/javascript" src\x3d"' + a + '"\x3e\x3c/script\x3e')
  }};
  (function() {
    var a = {};
    g.Fn = {set:function(b, e) {
      a[b] = e
    }, get:function(b, e) {
      var c = a[b];
      e && delete a[b];
      return c
    }}
  })();
  g.Socket = function(a) {
    var b = $(Z(a).concat([{incoming:function(b, e) {
      a.onMessage(b, e)
    }, callback:function(b) {
      if(a.onReady) {
        a.onReady(b)
      }
    }}])), e = r(a.remote);
    this.origin = r(a.remote);
    this.destroy = function() {
      b.destroy()
    };
    this.postMessage = function(a) {
      b.outgoing(a, e)
    };
    b.init()
  };
  g.Rpc = function(a, b) {
    if(b.local) {
      for(var e in b.local) {
        if(b.local.hasOwnProperty(e)) {
          var c = b.local[e];
          "function" === typeof c && (b.local[e] = {method:c})
        }
      }
    }
    var d = $(Z(a).concat([new g.stack.RpcBehavior(this, b), {callback:function(b) {
      if(a.onReady) {
        a.onReady(b)
      }
    }}]));
    this.origin = r(a.remote);
    this.destroy = function() {
      d.destroy()
    };
    d.init()
  };
  g.stack.SameOriginTransport = function(a) {
    var b, e, c, d;
    return b = {outgoing:function(a, b, e) {
      c(a);
      e && e()
    }, destroy:function() {
      e && (e.parentNode.removeChild(e), e = null)
    }, onDOMReady:function() {
      d = r(a.remote);
      a.isHost ? (s(a.props, {src:F(a.remote, {xdm_e:f.protocol + "//" + f.host + f.pathname, xdm_c:a.channel, xdm_p:4}), name:v + a.channel + "_provider"}), e = A(a), g.Fn.set(a.channel, function(a) {
        c = a;
        l(function() {
          b.up.callback(!0)
        }, 0);
        return function(a) {
          b.up.incoming(a, d)
        }
      })) : (c = ba().Fn.get(a.channel, !0)(function(a) {
        b.up.incoming(a, d)
      }), l(function() {
        b.up.callback(!0)
      }, 0))
    }, init:function() {
      D(b.onDOMReady, b)
    }}
  };
  g.stack.FlashTransport = function(a) {
    function b(a, b) {
      l(function() {
        c.up.incoming(a, k)
      }, 0)
    }
    function e(b) {
      var e = a.swf + "?host\x3d" + a.isHost, c = "easyXDM_swf_" + Math.floor(1E4 * Math.random());
      g.Fn.set("flash_loaded" + b.replace(/[\-.]/g, "_"), function() {
        g.stack.FlashTransport[b].swf = p = m.firstChild;
        for(var a = g.stack.FlashTransport[b].queue, e = 0;e < a.length;e++) {
          a[e]()
        }
        a.length = 0
      });
      a.swfContainer ? m = "string" == typeof a.swfContainer ? d.getElementById(a.swfContainer) : a.swfContainer : (m = d.createElement("div"), s(m.style, R && a.swfNoThrottle ? {height:"20px", width:"20px", position:"fixed", right:0, top:0} : {height:"1px", width:"1px", position:"absolute", overflow:"hidden", right:0, top:0}), d.body.appendChild(m));
      var h = "callback\x3dflash_loaded" + b.replace(/[\-.]/g, "_") + "\x26proto\x3d" + O.location.protocol + "\x26domain\x3d" + O.location.href.match(M)[3] + "\x26port\x3d" + (O.location.href.match(M)[4] || "") + "\x26ns\x3d" + H;
      m.innerHTML = "\x3cobject height\x3d'20' width\x3d'20' type\x3d'application/x-shockwave-flash' id\x3d'" + c + "' data\x3d'" + e + "'\x3e\x3cparam name\x3d'allowScriptAccess' value\x3d'always'\x3e\x3c/param\x3e\x3cparam name\x3d'wmode' value\x3d'transparent'\x3e\x3cparam name\x3d'movie' value\x3d'" + e + "'\x3e\x3c/param\x3e\x3cparam name\x3d'flashvars' value\x3d'" + h + "'\x3e\x3c/param\x3e\x3cembed type\x3d'application/x-shockwave-flash' FlashVars\x3d'" + h + "' allowScriptAccess\x3d'always' wmode\x3d'transparent' src\x3d'" + 
      e + "' height\x3d'1' width\x3d'1'\x3e\x3c/embed\x3e\x3c/object\x3e"
    }
    var c, u, k, p, m;
    return c = {outgoing:function(b, e, c) {
      p.postMessage(a.channel, b.toString());
      c && c()
    }, destroy:function() {
      try {
        p.destroyChannel(a.channel)
      }catch(b) {
      }
      p = null;
      u && (u.parentNode.removeChild(u), u = null)
    }, onDOMReady:function() {
      k = a.remote;
      g.Fn.set("flash_" + a.channel + "_init", function() {
        l(function() {
          c.up.callback(!0)
        })
      });
      g.Fn.set("flash_" + a.channel + "_onMessage", b);
      a.swf = I(a.swf);
      var d = a.swf.match(M)[3], m = function() {
        g.stack.FlashTransport[d].init = !0;
        p = g.stack.FlashTransport[d].swf;
        p.createChannel(a.channel, a.secret, r(a.remote), a.isHost);
        a.isHost && (R && a.swfNoThrottle && s(a.props, {position:"fixed", right:0, top:0, height:"20px", width:"20px"}), s(a.props, {src:F(a.remote, {xdm_e:r(f.href), xdm_c:a.channel, xdm_p:6, xdm_s:a.secret}), name:v + a.channel + "_provider"}), u = A(a))
      };
      g.stack.FlashTransport[d] && g.stack.FlashTransport[d].init ? m() : g.stack.FlashTransport[d] ? g.stack.FlashTransport[d].queue.push(m) : (g.stack.FlashTransport[d] = {queue:[m]}, e(d))
    }, init:function() {
      D(c.onDOMReady, c)
    }}
  };
  g.stack.PostMessageTransport = function(a) {
    function b(b) {
      var c;
      if(b.origin) {
        c = r(b.origin)
      }else {
        if(b.uri) {
          c = r(b.uri)
        }else {
          if(b.domain) {
            c = f.protocol + "//" + b.domain
          }else {
            throw"Unable to retrieve the origin of the event";
          }
        }
      }
      c == k && b.data.substring(0, a.channel.length + 1) == a.channel + " " && e.up.incoming(b.data.substring(a.channel.length + 1), c)
    }
    var e, h, d, k;
    return e = {outgoing:function(b, e, c) {
      d.postMessage(a.channel + " " + b, e || k);
      c && c()
    }, destroy:function() {
      G(c, "message", b);
      h && (d = null, h.parentNode.removeChild(h), h = null)
    }, onDOMReady:function() {
      k = r(a.remote);
      if(a.isHost) {
        var p = function(k) {
          k.data == a.channel + "-ready" && (d = "postMessage" in h.contentWindow ? h.contentWindow : h.contentWindow.document, G(c, "message", p), w(c, "message", b), l(function() {
            e.up.callback(!0)
          }, 0))
        };
        w(c, "message", p);
        s(a.props, {src:F(a.remote, {xdm_e:r(f.href), xdm_c:a.channel, xdm_p:1}), name:v + a.channel + "_provider"});
        h = A(a)
      }else {
        w(c, "message", b), d = "postMessage" in c.parent ? c.parent : c.parent.document, d.postMessage(a.channel + "-ready", k), l(function() {
          e.up.callback(!0)
        }, 0)
      }
    }, init:function() {
      D(e.onDOMReady, e)
    }}
  };
  g.stack.FrameElementTransport = function(a) {
    var b, e, h, g;
    return b = {outgoing:function(a, b, e) {
      h.call(this, a);
      e && e()
    }, destroy:function() {
      e && (e.parentNode.removeChild(e), e = null)
    }, onDOMReady:function() {
      g = r(a.remote);
      a.isHost ? (s(a.props, {src:F(a.remote, {xdm_e:r(f.href), xdm_c:a.channel, xdm_p:5}), name:v + a.channel + "_provider"}), e = A(a), e.fn = function(a) {
        delete e.fn;
        h = a;
        l(function() {
          b.up.callback(!0)
        }, 0);
        return function(a) {
          b.up.incoming(a, g)
        }
      }) : (d.referrer && r(d.referrer) != t.xdm_e && (c.top.location = t.xdm_e), h = c.frameElement.fn(function(a) {
        b.up.incoming(a, g)
      }), b.up.callback(!0))
    }, init:function() {
      D(b.onDOMReady, b)
    }}
  };
  g.stack.NameTransport = function(a) {
    function b(b) {
      m.contentWindow.sendMessage(b, a.remoteHelper + (f ? "#_3" : "#_2") + a.channel)
    }
    function e() {
      f ? (2 === ++n || !f) && k.up.callback(!0) : (b("ready"), k.up.callback(!0))
    }
    function c(a) {
      k.up.incoming(a, J)
    }
    function d() {
      z && l(function() {
        z(!0)
      }, 0)
    }
    var k, f, m, q, n, z, J, Q;
    return k = {outgoing:function(a, e, c) {
      z = c;
      b(a)
    }, destroy:function() {
      m.parentNode.removeChild(m);
      m = null;
      f && (q.parentNode.removeChild(q), q = null)
    }, onDOMReady:function() {
      f = a.isHost;
      n = 0;
      J = r(a.remote);
      a.local = I(a.local);
      f ? (g.Fn.set(a.channel, function(b) {
        f && "ready" === b && (g.Fn.set(a.channel, c), e())
      }), Q = F(a.remote, {xdm_e:a.local, xdm_c:a.channel, xdm_p:2}), s(a.props, {src:Q + "#" + a.channel, name:v + a.channel + "_provider"}), q = A(a)) : (a.remoteHelper = a.remote, g.Fn.set(a.channel, c));
      var b = function() {
        var c = m || this;
        G(c, "load", b);
        g.Fn.set(a.channel + "_load", d);
        (function ha() {
          "function" == typeof c.contentWindow.sendMessage ? e() : l(ha, 50)
        })()
      };
      m = A({props:{src:a.local + "#_4" + a.channel}, onLoad:b})
    }, init:function() {
      D(k.onDOMReady, k)
    }}
  };
  g.stack.HashTransport = function(a) {
    function b() {
      if(q) {
        var a = q.location.href, b = "", c = a.indexOf("#");
        -1 != c && (b = a.substring(c));
        b && b != f && (f = b, e.up.incoming(f.substring(f.indexOf("_") + 1), J))
      }
    }
    var e, h, d, k, f, g, q, n, z, J;
    return e = {outgoing:function(b, c) {
      if(n) {
        var e = a.remote + "#" + g++ + "_" + b;
        (h || !z ? n.contentWindow : n).location = e
      }
    }, destroy:function() {
      c.clearInterval(d);
      (h || !z) && n.parentNode.removeChild(n);
      n = null
    }, onDOMReady:function() {
      h = a.isHost;
      k = a.interval;
      f = "#" + a.channel;
      g = 0;
      z = a.useParent;
      J = r(a.remote);
      if(h) {
        s(a.props, {src:a.remote, name:v + a.channel + "_provider"});
        if(z) {
          a.onLoad = function() {
            q = c;
            d = setInterval(b, k);
            e.up.callback(!0)
          }
        }else {
          var Q = 0, fa = a.delay / 50;
          (function ga() {
            if(++Q > fa) {
              throw Error("Unable to reference listenerwindow");
            }
            try {
              q = n.contentWindow.frames[v + a.channel + "_consumer"]
            }catch(c) {
            }
            q ? (d = setInterval(b, k), e.up.callback(!0)) : l(ga, 50)
          })()
        }
        n = A(a)
      }else {
        q = c, d = setInterval(b, k), z ? (n = parent, e.up.callback(!0)) : (s(a, {props:{src:a.remote + "#" + a.channel + new Date, name:v + a.channel + "_consumer"}, onLoad:function() {
          e.up.callback(!0)
        }}), n = A(a))
      }
    }, init:function() {
      D(e.onDOMReady, e)
    }}
  };
  g.stack.ReliableBehavior = function(a) {
    var b, c, d = 0, f = 0, k = "";
    return b = {incoming:function(a, g) {
      var l = a.indexOf("_"), n = a.substring(0, l).split(",");
      a = a.substring(l + 1);
      n[0] == d && (k = "", c && (c(!0), c = null));
      0 < a.length && (b.down.outgoing(n[1] + "," + d + "_" + k, g), f != n[1] && (f = n[1], b.up.incoming(a, g)))
    }, outgoing:function(a, g, l) {
      k = a;
      c = l;
      b.down.outgoing(f + "," + ++d + "_" + a, g)
    }}
  };
  g.stack.QueueBehavior = function(a) {
    function b() {
      if(a.remove && 0 === d.length) {
        da(c)
      }else {
        if(!f && !(0 === d.length || p)) {
          f = !0;
          var g = d.shift();
          c.down.outgoing(g.data, g.origin, function(a) {
            f = !1;
            g.callback && l(function() {
              g.callback(a)
            }, 0);
            b()
          })
        }
      }
    }
    var c, d = [], f = !0, g = "", p, m = 0, q = !1, n = !1;
    return c = {init:function() {
      y(a) && (a = {});
      a.maxLength && (m = a.maxLength, n = !0);
      a.lazy ? q = !0 : c.down.init()
    }, callback:function(a) {
      f = !1;
      var d = c.up;
      b();
      d.callback(a)
    }, incoming:function(b, d) {
      if(n) {
        var h = b.indexOf("_"), f = parseInt(b.substring(0, h), 10);
        g += b.substring(h + 1);
        0 === f && (a.encode && (g = x(g)), c.up.incoming(g, d), g = "")
      }else {
        c.up.incoming(b, d)
      }
    }, outgoing:function(g, f, k) {
      a.encode && (g = U(g));
      var l = [], p;
      if(n) {
        for(;0 !== g.length;) {
          p = g.substring(0, m), g = g.substring(p.length), l.push(p)
        }
        for(;p = l.shift();) {
          d.push({data:l.length + "_" + p, origin:f, callback:0 === l.length ? k : null})
        }
      }else {
        d.push({data:g, origin:f, callback:k})
      }
      q ? c.down.init() : b()
    }, destroy:function() {
      p = !0;
      c.down.destroy()
    }}
  };
  g.stack.VerifyBehavior = function(a) {
    function b() {
      d = Math.random().toString(16).substring(2);
      c.down.outgoing(d)
    }
    var c, d, g;
    return c = {incoming:function(f, l) {
      var m = f.indexOf("_");
      -1 === m ? f === d ? c.up.callback(!0) : g || (g = f, a.initiate || b(), c.down.outgoing(f)) : f.substring(0, m) === g && c.up.incoming(f.substring(m + 1), l)
    }, outgoing:function(a, b, g) {
      c.down.outgoing(d + "_" + a, b, g)
    }, callback:function(c) {
      a.initiate && b()
    }}
  };
  g.stack.RpcBehavior = function(a, b) {
    function c(a) {
      a.jsonrpc = "2.0";
      f.down.outgoing(l.stringify(a))
    }
    function d(a, b) {
      var g = Array.prototype.slice;
      return function() {
        var d = arguments.length, f, h = {method:b};
        0 < d && "function" === typeof arguments[d - 1] ? (1 < d && "function" === typeof arguments[d - 2] ? (f = {success:arguments[d - 2], error:arguments[d - 1]}, h.params = g.call(arguments, 0, d - 2)) : (f = {success:arguments[d - 1]}, h.params = g.call(arguments, 0, d - 1)), q["" + ++m] = f, h.id = m) : h.params = g.call(arguments, 0);
        a.namedParams && 1 === h.params.length && (h.params = h.params[0]);
        c(h)
      }
    }
    function g(a, b, d, f) {
      if(d) {
        var h, l;
        b ? (h = function(a) {
          h = S;
          c({id:b, result:a})
        }, l = function(a, d) {
          l = S;
          var f = {id:b, error:{code:-32099, message:a}};
          d && (f.error.data = d);
          c(f)
        }) : h = l = S;
        "[object Array]" !== Object.prototype.toString.call(f) && (f = [f]);
        try {
          var k = d.method.apply(d.scope, f.concat([h, l]));
          y(k) || h(k)
        }catch(m) {
          l(m.message)
        }
      }else {
        b && c({id:b, error:{code:-32601, message:"Procedure not found."}})
      }
    }
    var f, l = b.serializer || T(), m = 0, q = {};
    return f = {incoming:function(a, d) {
      var f = l.parse(a);
      if(f.method) {
        b.handle ? b.handle(f, c) : g(f.method, f.id, b.local[f.method], f.params)
      }else {
        var h = q[f.id];
        f.error ? h.error && h.error(f.error) : h.success && h.success(f.result);
        delete q[f.id]
      }
    }, init:function() {
      if(b.remote) {
        for(var c in b.remote) {
          b.remote.hasOwnProperty(c) && (a[c] = d(b.remote[c], c))
        }
      }
      f.down.init()
    }, destroy:function() {
      for(var c in b.remote) {
        b.remote.hasOwnProperty(c) && a.hasOwnProperty(c) && delete a[c]
      }
      f.down.destroy()
    }}
  };
  O.easyXDM = g
})(window, document, location, window.setTimeout, decodeURIComponent, encodeURIComponent);
var promise = function() {
};
promise.prototype = {pending:{resolve:function() {
}, reject:function() {
}}, then:function(c, d) {
  this.pending = {resolve:c, reject:d};
  return this
}, resolve:function(c) {
  this.pending.resolve(c)
}, reject:function(c) {
  this.pending.reject(c)
}};
try {
  addToNamespace("Promise", promise)
}catch(e$$13) {
  throw Error("Cannot extends 'Promise' to 'Adfab.playground.Promise'");
}
;var user = {env:{}, id:null, uid:null, data:{}, urls:{current:top.location.href, prev:null}, init:function() {
  PG.Util.GenerateUniqueId();
  PG.User.urls.prev = PG.Util.readCookie("prev-url");
  var c = PG.Util.readCookie("authent"), d = PG.Util.readCookie("last-sync"), f = (new Date).getTime();
  if(!PG.Util.not_null(d) || parseInt(d) + 86400 < f) {
    c = null
  }
  PG.Util.not_null(c) ? (PG.User.data = JSON.parse(PG.Util.readCookie("authent")), PG.User.checkUser()) : PG.User.loadAuthent().then(function() {
    PG.User.checkUser()
  })
}, isLogged:function() {
  var c;
  if("" === PG.User.id || null === PG.User.id) {
    PG.User.id = PG.Util.readCookie("login")
  }
  c = PG.Util.not_null(PG.User.id) ? !0 : !1;
  PG.Util.log("isLogged : " + c);
  return c
}, loadAuthent:function() {
  var c = new PG.Promise;
  PG.App.call(PG.Config.env[PG.Config.mode].connect).then(function(d) {
    PG.User.data = d;
    PG.Util.createCookie("last-sync", (new Date).getTime());
    PG.Util.createCookie("authent", JSON.stringify(d));
    c.resolve()
  });
  return c
}, checkUser:function() {
  PG.User.isLogged() && PG.Util.not_null(PG.Util.readCookie("logout-try")) ? PG.Util.not_null(PG.User.data.library.stories.logout_user) && (PG.Util.not_null(PG.User.data.library.stories.logout_user.events.after) && PG.User.checkStory(PG.User.data.library.stories.logout_user.events.after)) && PG.User.logout() : !PG.User.isLogged() && PG.Util.not_null(PG.Util.readCookie("login-try")) ? PG.Util.not_null(PG.User.data.library.stories.login_user) && (PG.Util.not_null(PG.User.data.library.stories.login_user.events.after) && 
  PG.User.checkStory(PG.User.data.library.stories.login_user.events.after)) && PG.User.login(PG.Util.readCookie("login-try")) : !PG.User.isLogged() && PG.Util.not_null(PG.Util.readCookie("login")) ? PG.User.login(PG.Util.readCookie("login")) : PG.User.isLogged() && PG.User.logout();
  PG.Util.eraseCookie("logout-try");
  PG.Util.eraseCookie("login-try");
  PG.App.send(top.location.href)
}, login:function(c) {
  PG.Util.log('Login "' + c + '"');
  PG.Util.not_null(c) && (PG.User.id = c, PG.Util.createCookie("login", c));
  return PG.User.data.id
}, logout:function() {
  PG.Util.log("User is out");
  PG.Util.eraseCookie("login");
  PG.User.id = null
}, checkStory:function(c) {
  var d = !1;
  PG.Util.not_null(c) && (PG.Util.not_null(c.url) && PG.Util.not_null(c.xpath) && PG.Util.matchUrl(c.url) && PG.Util.checkXpath(c.xpath) ? d = !0 : PG.Util.not_null(c.url) && PG.Util.matchUrl(c.url) && !PG.Util.not_null(c.xpath) ? d = !0 : PG.Util.not_null(c.xpath) && (PG.Util.checkXpath(c.xpath) && !PG.Util.not_null(c.url)) && (d = !0));
  console.log("use : " + d);
  return d
}, getStory:function(c, d, f) {
  c = {user:{anonymous:PG.User.uid}, objects:{}, action:d, url:c, apiKey:PG.Settings.apiKey};
  PG.User.isLogged() && (c.user.login = PG.User.id);
  PG.Util.not_null(f) && (c.objects = {id:f.id, properties:[]}, 0 < f.properties.length && (PG.Util.not_null(f.properties[0].xpath) && PG.Util.not_null(f.properties[0].name) && PG.Util.not_null(PG.Util.getObjectFromXpath(f.properties[0].xpath)[0])) && (c.objects.properties = {name:f.properties[0].name, value:PG.Util.getValueFromObject(PG.Util.getObjectFromXpath(f.properties[0].xpath)[0])}));
  return c
}, quit:function() {
  var c;
  PG.Util.createCookie("prev-url", top.location.href);
  PG.User.isLogged() ? PG.Util.not_null(PG.User.data.library.stories.logout_user) && PG.Util.not_null(PG.User.data.library.stories.logout_user.events.before) && PG.User.checkStory(PG.User.data.library.stories.logout_user.events.before) && (PG.User.getStory(top.location.href, "logout_user", PG.User.data.library.stories.logout_user.objects), PG.Util.createCookie("logout-try", "true")) : PG.Util.not_null(PG.User.data.library.stories.login_user) && PG.Util.not_null(PG.User.data.library.stories.login_user.events.before) && 
  PG.User.checkStory(PG.User.data.library.stories.login_user.events.before) && (c = PG.User.getStory(top.location.href, "login_user", PG.User.data.library.stories.login_user.objects), PG.Util.not_null(c.objects.properties.value) && PG.Util.createCookie("login-try", c.objects.properties.value))
}};
try {
  addToNamespace("User", user)
}catch(e$$14) {
  throw Error("Cannot extends 'User' to 'Adfab.playground.User'");
}
;function App() {
  return this
}
App.prototype.init = function() {
  PG.Util.not_null(PG.Settings) && PG.Util.not_null(PG.Settings.apiKey) ? (PG.Util.log("APIKEY FOUND \x3d " + PG.Settings.apiKey), PG.App.easyXDM(), PG.App.bindEvent(), PG.User.init(), PG.Util.fireEvt("earsReady", window, {apiKey:PG.Settings.apiKey, uid:PG.User.uid, login:PG.User.id})) : PG.Util.log("NO APIKEY FOUND")
};
App.prototype.bindEvent = function() {
  var c, d, f;
  c = PG.Cache.xmlhttp.prototype.open;
  d = PG.Cache.xmlhttp.prototype.send;
  PG.Cache.xmlhttp.prototype.open = function(d, x) {
    d || (d = "");
    x || (x = "");
    c.apply(this, arguments);
    f = d;
    "get" == d.toLowerCase() && x.split("?")
  };
  PG.Cache.xmlhttp.prototype.send = function(c, x) {
    c || (c = "");
    x || (x = "");
    d.apply(this, arguments);
    f.toLowerCase()
  };
  PG.Cache.document.onreadystatechange = function(c) {
    PG.Util.not_null(c.data)
  };
  PG.Cache.window.onbeforeunload = function(c) {
    PG.User.quit();
    return null
  }
};
App.prototype.easyXDM = function() {
  PG.App.rpc = new easyXDM.Rpc({local:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "easyXDM/name.html", swf:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "easyXDM/easyxdm.swf", remote:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "index.html"}, {remote:{request:{}}})
};
App.prototype.send = function(c) {
  var d = PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + PG.Config.env[PG.Config.mode].send, f, l;
  if(!PG.Util.isUrlValid(c)) {
    return!1
  }
  for(l in PG.User.data.library.stories) {
    f = PG.User.data.library.stories[l], PG.User.checkStory(f.conditions) && (f = PG.User.getStory(c, f.action, f.objects), PG.App.rpc.request({url:d, method:"POST", data:f, headers:{"Content-Type":"application/json; charset\x3dutf-8"}}, function(c) {
    }, function(c) {
      throw"Api Error, code : " + c.code + ", msg : " + c.message;
    }))
  }
  return!0
};
App.prototype.call = function(c) {
  var d = new PG.Promise;
  PG.Util.log("call service : " + c);
  PG.App.rpc.request({url:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + c + "?apiKey\x3d" + PG.Settings.apiKey}, function(c) {
    d.resolve(JSON.parse(c.data))
  }, function(c) {
    throw"Api Error, code : " + c.code + ", msg : " + c.message;
  });
  return d
};
var app = new App;
try {
  addToNamespace("App", app)
}catch(e$$17) {
  throw Error("Cannot extends 'app' to 'Adfab.playground.App'");
}
app.init();
