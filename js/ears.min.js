(function(c, d, g, k, s, U) {
  function E(a, b) {
    var f = typeof a[b];
    return"function" == f || !!("object" == f && a[b]) || "unknown" == f
  }
  function V() {
    if(!y(navigator.plugins) && "object" == typeof navigator.plugins["Shockwave Flash"]) {
      var a = navigator.plugins["Shockwave Flash"].description;
      a && (!y(navigator.mimeTypes) && navigator.mimeTypes["application/x-shockwave-flash"] && navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin) && (B = a.match(/\d+/g))
    }
    if(!B) {
      var b;
      try {
        b = new ActiveXObject("ShockwaveFlash.ShockwaveFlash"), B = Array.prototype.slice.call(b.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/), 1)
      }catch(f) {
      }
    }
    if(!B) {
      return!1
    }
    a = parseInt(B[0], 10);
    b = parseInt(B[1], 10);
    R = 9 < a && 0 < b;
    return!0
  }
  function K() {
    if(!C) {
      C = !0;
      for(var a = 0;a < L.length;a++) {
        L[a]()
      }
      L.length = 0
    }
  }
  function D(a, b) {
    C ? a.call(b) : L.push(function() {
      a.call(b)
    })
  }
  function ba() {
    var a = parent;
    if("" !== H) {
      for(var b = 0, f = H.split(".");b < f.length;b++) {
        a = a[f[b]]
      }
    }
    return a.easyXDM
  }
  function q(a) {
    var b = a.toLowerCase().match(M);
    a = b[2];
    var f = b[3], b = b[4] || "";
    if("http:" == a && ":80" == b || "https:" == a && ":443" == b) {
      b = ""
    }
    return a + "//" + f + b
  }
  function I(a) {
    a = a.replace(ca, "$1/");
    if(!a.match(/^(http||https):\/\//)) {
      var b = "/" === a.substring(0, 1) ? "" : g.pathname;
      "/" !== b.substring(b.length - 1) && (b = b.substring(0, b.lastIndexOf("/") + 1));
      a = g.protocol + "//" + g.host + b + a
    }
    for(;W.test(a);) {
      a = a.replace(W, "")
    }
    return a
  }
  function F(a, b) {
    var f = "", h = a.indexOf("#");
    -1 !== h && (f = a.substring(h), a = a.substring(0, h));
    var h = [], c;
    for(c in b) {
      b.hasOwnProperty(c) && h.push(c + "\x3d" + U(b[c]))
    }
    return a + (X ? "#" : -1 == a.indexOf("?") ? "?" : "\x26") + h.join("\x26") + f
  }
  function y(a) {
    return"undefined" === typeof a
  }
  function r(a, b, f) {
    var h, c;
    for(c in b) {
      b.hasOwnProperty(c) && (c in a ? (h = b[c], "object" === typeof h ? r(a[c], h, f) : f || (a[c] = b[c])) : a[c] = b[c])
    }
    return a
  }
  function A(a) {
    if(y(N)) {
      var b = d.body.appendChild(d.createElement("form")), f = b.appendChild(d.createElement("input"));
      f.name = w + "TEST" + Y;
      N = f !== b.elements[f.name];
      d.body.removeChild(b)
    }
    N ? b = d.createElement('\x3ciframe name\x3d"' + a.props.name + '"/\x3e') : (b = d.createElement("IFRAME"), b.name = a.props.name);
    b.id = b.name = a.props.name;
    delete a.props.name;
    "string" == typeof a.container && (a.container = d.getElementById(a.container));
    a.container || (r(b.style, {position:"absolute", top:"-2000px", left:"0px"}), a.container = d.body);
    f = a.props.src;
    a.props.src = "javascript:false";
    r(b, a.props);
    b.border = b.frameBorder = 0;
    b.allowTransparency = !0;
    a.container.appendChild(b);
    a.onLoad && x(b, "load", a.onLoad);
    if(a.usePost) {
      var h = a.container.appendChild(d.createElement("form")), c;
      h.target = b.name;
      h.action = f;
      h.method = "POST";
      if("object" === typeof a.usePost) {
        for(var l in a.usePost) {
          a.usePost.hasOwnProperty(l) && (N ? c = d.createElement('\x3cinput name\x3d"' + l + '"/\x3e') : (c = d.createElement("INPUT"), c.name = l), c.value = a.usePost[l], h.appendChild(c))
        }
      }
      h.submit();
      h.parentNode.removeChild(h)
    }else {
      b.src = f
    }
    a.props.src = f;
    return b
  }
  function Z(a) {
    var b = a.protocol, f;
    a.isHost = a.isHost || y(u.xdm_p);
    X = a.hash || !1;
    a.props || (a.props = {});
    if(a.isHost) {
      a.remote = I(a.remote), a.channel = a.channel || "default" + Y++, a.secret = Math.random().toString(16).substring(2), y(b) && (b = q(g.href) == q(a.remote) ? "4" : E(c, "postMessage") || E(d, "postMessage") ? "1" : a.swf && E(c, "ActiveXObject") && V() ? "6" : "Gecko" === navigator.product && "frameElement" in c && -1 == navigator.userAgent.indexOf("WebKit") ? "5" : a.remoteHelper ? "2" : "0")
    }else {
      a.channel = u.xdm_c.replace(/["'<>\\]/g, "");
      a.secret = u.xdm_s;
      a.remote = u.xdm_e.replace(/["'<>\\]/g, "");
      var b = u.xdm_p, h;
      if(h = a.acl) {
        a: {
          h = a.acl;
          var v = a.remote;
          "string" == typeof h && (h = [h]);
          for(var l, n = h.length;n--;) {
            if(l = h[n], l = RegExp("^" == l.substr(0, 1) ? l : "^" + l.replace(/(\*)/g, ".$1").replace(/\?/g, ".") + "$"), l.test(v)) {
              h = !0;
              break a
            }
          }
          h = !1
        }
        h = !h
      }
      if(h) {
        throw Error("Access denied for " + a.remote);
      }
    }
    a.protocol = b;
    switch(b) {
      case "0":
        r(a, {interval:100, delay:2E3, useResize:!0, useParent:!1, usePolling:!1}, !0);
        if(a.isHost) {
          if(!a.local) {
            b = g.protocol + "//" + g.host;
            f = d.body.getElementsByTagName("img");
            for(v = f.length;v--;) {
              if(h = f[v], h.src.substring(0, b.length) === b) {
                a.local = h.src;
                break
              }
            }
            a.local || (a.local = c)
          }
          b = {xdm_c:a.channel, xdm_p:0};
          a.local === c ? (a.usePolling = !0, a.useParent = !0, a.local = g.protocol + "//" + g.host + g.pathname + g.search, b.xdm_e = a.local, b.xdm_pa = 1) : b.xdm_e = I(a.local);
          a.container && (a.useResize = !1, b.xdm_po = 1);
          a.remote = F(a.remote, b)
        }else {
          r(a, {channel:u.xdm_c, remote:u.xdm_e, useParent:!y(u.xdm_pa), usePolling:!y(u.xdm_po), useResize:a.useParent ? !1 : a.useResize})
        }
        f = [new e.stack.HashTransport(a), new e.stack.ReliableBehavior({}), new e.stack.QueueBehavior({encode:!0, maxLength:4E3 - a.remote.length}), new e.stack.VerifyBehavior({initiate:a.isHost})];
        break;
      case "1":
        f = [new e.stack.PostMessageTransport(a)];
        break;
      case "2":
        a.remoteHelper = I(a.remoteHelper);
        f = [new e.stack.NameTransport(a), new e.stack.QueueBehavior, new e.stack.VerifyBehavior({initiate:a.isHost})];
        break;
      case "3":
        f = [new e.stack.NixTransport(a)];
        break;
      case "4":
        f = [new e.stack.SameOriginTransport(a)];
        break;
      case "5":
        f = [new e.stack.FrameElementTransport(a)];
        break;
      case "6":
        B || V(), f = [new e.stack.FlashTransport(a)]
    }
    f.push(new e.stack.QueueBehavior({lazy:a.lazy, remove:!0}));
    return f
  }
  function $(a) {
    for(var b, f = {incoming:function(a, b) {
      this.up.incoming(a, b)
    }, outgoing:function(a, b) {
      this.down.outgoing(a, b)
    }, callback:function(a) {
      this.up.callback(a)
    }, init:function() {
      this.down.init()
    }, destroy:function() {
      this.down.destroy()
    }}, c = 0, d = a.length;c < d;c++) {
      b = a[c], r(b, f, !0), 0 !== c && (b.down = a[c - 1]), c !== d - 1 && (b.up = a[c + 1])
    }
    return b
  }
  function da(a) {
    a.up.down = a.down;
    a.down.up = a.up;
    a.up = a.down = null
  }
  var O = this, Y = Math.floor(1E4 * Math.random()), S = Function.prototype, M = /^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/, W = /[\-\w]+\/\.\.\//, ca = /([^:])\/\//g, H = "", e = {}, ea = c.easyXDM, w = "easyXDM_", N, X = !1, B, R, x, G;
  if(E(c, "addEventListener")) {
    x = function(a, b, f) {
      a.addEventListener(b, f, !1)
    }, G = function(a, b, f) {
      a.removeEventListener(b, f, !1)
    }
  }else {
    if(E(c, "attachEvent")) {
      x = function(a, b, f) {
        a.attachEvent("on" + b, f)
      }, G = function(a, b, f) {
        a.detachEvent("on" + b, f)
      }
    }else {
      throw Error("Browser not supported");
    }
  }
  var C = !1, L = [], P;
  "readyState" in d ? (P = d.readyState, C = "complete" == P || ~navigator.userAgent.indexOf("AppleWebKit/") && ("loaded" == P || "interactive" == P)) : C = !!d.body;
  if(!C) {
    if(E(c, "addEventListener")) {
      x(d, "DOMContentLoaded", K)
    }else {
      if(x(d, "readystatechange", function() {
        "complete" == d.readyState && K()
      }), d.documentElement.doScroll && c === top) {
        var aa = function() {
          if(!C) {
            try {
              d.documentElement.doScroll("left")
            }catch(a) {
              k(aa, 1);
              return
            }
            K()
          }
        };
        aa()
      }
    }
    x(c, "load", K)
  }
  var u = function(a) {
    a = a.substring(1).split("\x26");
    for(var b = {}, f, c = a.length;c--;) {
      f = a[c].split("\x3d"), b[f[0]] = s(f[1])
    }
    return b
  }(/xdm_e=/.test(g.search) ? g.search : g.hash), T = function() {
    var a = {}, b = {a:[1, 2, 3]};
    if("undefined" != typeof JSON && "function" === typeof JSON.stringify && '{"a":[1,2,3]}' === JSON.stringify(b).replace(/\s/g, "")) {
      return JSON
    }
    Object.toJSON && '{"a":[1,2,3]}' === Object.toJSON(b).replace(/\s/g, "") && (a.stringify = Object.toJSON);
    "function" === typeof String.prototype.evalJSON && (b = '{"a":[1,2,3]}'.evalJSON(), b.a && (3 === b.a.length && 3 === b.a[2]) && (a.parse = function(a) {
      return a.evalJSON()
    }));
    return a.stringify && a.parse ? (T = function() {
      return a
    }, a) : null
  };
  r(e, {version:"2.4.17.1", query:u, stack:{}, apply:r, getJSONObject:T, whenReady:D, noConflict:function(a) {
    c.easyXDM = ea;
    (H = a) && (w = "easyXDM_" + H.replace(".", "_") + "_");
    return e
  }});
  e.DomHelper = {on:x, un:G, requiresJSON:function(a) {
    "object" == typeof c.JSON && c.JSON || d.write('\x3cscript type\x3d"text/javascript" src\x3d"' + a + '"\x3e\x3c/script\x3e')
  }};
  (function() {
    var a = {};
    e.Fn = {set:function(b, f) {
      a[b] = f
    }, get:function(b, f) {
      var c = a[b];
      f && delete a[b];
      return c
    }}
  })();
  e.Socket = function(a) {
    var b = $(Z(a).concat([{incoming:function(b, f) {
      a.onMessage(b, f)
    }, callback:function(b) {
      if(a.onReady) {
        a.onReady(b)
      }
    }}])), f = q(a.remote);
    this.origin = q(a.remote);
    this.destroy = function() {
      b.destroy()
    };
    this.postMessage = function(a) {
      b.outgoing(a, f)
    };
    b.init()
  };
  e.Rpc = function(a, b) {
    if(b.local) {
      for(var f in b.local) {
        if(b.local.hasOwnProperty(f)) {
          var c = b.local[f];
          "function" === typeof c && (b.local[f] = {method:c})
        }
      }
    }
    var d = $(Z(a).concat([new e.stack.RpcBehavior(this, b), {callback:function(b) {
      if(a.onReady) {
        a.onReady(b)
      }
    }}]));
    this.origin = q(a.remote);
    this.destroy = function() {
      d.destroy()
    };
    d.init()
  };
  e.stack.SameOriginTransport = function(a) {
    var b, f, c, d;
    return b = {outgoing:function(a, b, f) {
      c(a);
      f && f()
    }, destroy:function() {
      f && (f.parentNode.removeChild(f), f = null)
    }, onDOMReady:function() {
      d = q(a.remote);
      a.isHost ? (r(a.props, {src:F(a.remote, {xdm_e:g.protocol + "//" + g.host + g.pathname, xdm_c:a.channel, xdm_p:4}), name:w + a.channel + "_provider"}), f = A(a), e.Fn.set(a.channel, function(a) {
        c = a;
        k(function() {
          b.up.callback(!0)
        }, 0);
        return function(a) {
          b.up.incoming(a, d)
        }
      })) : (c = ba().Fn.get(a.channel, !0)(function(a) {
        b.up.incoming(a, d)
      }), k(function() {
        b.up.callback(!0)
      }, 0))
    }, init:function() {
      D(b.onDOMReady, b)
    }}
  };
  e.stack.FlashTransport = function(a) {
    function b(a, b) {
      k(function() {
        c.up.incoming(a, l)
      }, 0)
    }
    function f(b) {
      var c = a.swf + "?host\x3d" + a.isHost, f = "easyXDM_swf_" + Math.floor(1E4 * Math.random());
      e.Fn.set("flash_loaded" + b.replace(/[\-.]/g, "_"), function() {
        e.stack.FlashTransport[b].swf = n = m.firstChild;
        for(var a = e.stack.FlashTransport[b].queue, c = 0;c < a.length;c++) {
          a[c]()
        }
        a.length = 0
      });
      a.swfContainer ? m = "string" == typeof a.swfContainer ? d.getElementById(a.swfContainer) : a.swfContainer : (m = d.createElement("div"), r(m.style, R && a.swfNoThrottle ? {height:"20px", width:"20px", position:"fixed", right:0, top:0} : {height:"1px", width:"1px", position:"absolute", overflow:"hidden", right:0, top:0}), d.body.appendChild(m));
      var h = "callback\x3dflash_loaded" + b.replace(/[\-.]/g, "_") + "\x26proto\x3d" + O.location.protocol + "\x26domain\x3d" + O.location.href.match(M)[3] + "\x26port\x3d" + (O.location.href.match(M)[4] || "") + "\x26ns\x3d" + H;
      m.innerHTML = "\x3cobject height\x3d'20' width\x3d'20' type\x3d'application/x-shockwave-flash' id\x3d'" + f + "' data\x3d'" + c + "'\x3e\x3cparam name\x3d'allowScriptAccess' value\x3d'always'\x3e\x3c/param\x3e\x3cparam name\x3d'wmode' value\x3d'transparent'\x3e\x3cparam name\x3d'movie' value\x3d'" + c + "'\x3e\x3c/param\x3e\x3cparam name\x3d'flashvars' value\x3d'" + h + "'\x3e\x3c/param\x3e\x3cembed type\x3d'application/x-shockwave-flash' FlashVars\x3d'" + h + "' allowScriptAccess\x3d'always' wmode\x3d'transparent' src\x3d'" + 
      c + "' height\x3d'1' width\x3d'1'\x3e\x3c/embed\x3e\x3c/object\x3e"
    }
    var c, v, l, n, m;
    return c = {outgoing:function(b, c, f) {
      n.postMessage(a.channel, b.toString());
      f && f()
    }, destroy:function() {
      try {
        n.destroyChannel(a.channel)
      }catch(b) {
      }
      n = null;
      v && (v.parentNode.removeChild(v), v = null)
    }, onDOMReady:function() {
      l = a.remote;
      e.Fn.set("flash_" + a.channel + "_init", function() {
        k(function() {
          c.up.callback(!0)
        })
      });
      e.Fn.set("flash_" + a.channel + "_onMessage", b);
      a.swf = I(a.swf);
      var d = a.swf.match(M)[3], m = function() {
        e.stack.FlashTransport[d].init = !0;
        n = e.stack.FlashTransport[d].swf;
        n.createChannel(a.channel, a.secret, q(a.remote), a.isHost);
        a.isHost && (R && a.swfNoThrottle && r(a.props, {position:"fixed", right:0, top:0, height:"20px", width:"20px"}), r(a.props, {src:F(a.remote, {xdm_e:q(g.href), xdm_c:a.channel, xdm_p:6, xdm_s:a.secret}), name:w + a.channel + "_provider"}), v = A(a))
      };
      e.stack.FlashTransport[d] && e.stack.FlashTransport[d].init ? m() : e.stack.FlashTransport[d] ? e.stack.FlashTransport[d].queue.push(m) : (e.stack.FlashTransport[d] = {queue:[m]}, f(d))
    }, init:function() {
      D(c.onDOMReady, c)
    }}
  };
  e.stack.PostMessageTransport = function(a) {
    function b(b) {
      var c;
      if(b.origin) {
        c = q(b.origin)
      }else {
        if(b.uri) {
          c = q(b.uri)
        }else {
          if(b.domain) {
            c = g.protocol + "//" + b.domain
          }else {
            throw"Unable to retrieve the origin of the event";
          }
        }
      }
      c == l && b.data.substring(0, a.channel.length + 1) == a.channel + " " && f.up.incoming(b.data.substring(a.channel.length + 1), c)
    }
    var f, d, e, l;
    return f = {outgoing:function(b, c, f) {
      e.postMessage(a.channel + " " + b, c || l);
      f && f()
    }, destroy:function() {
      G(c, "message", b);
      d && (e = null, d.parentNode.removeChild(d), d = null)
    }, onDOMReady:function() {
      l = q(a.remote);
      if(a.isHost) {
        var n = function(l) {
          l.data == a.channel + "-ready" && (e = "postMessage" in d.contentWindow ? d.contentWindow : d.contentWindow.document, G(c, "message", n), x(c, "message", b), k(function() {
            f.up.callback(!0)
          }, 0))
        };
        x(c, "message", n);
        r(a.props, {src:F(a.remote, {xdm_e:q(g.href), xdm_c:a.channel, xdm_p:1}), name:w + a.channel + "_provider"});
        d = A(a)
      }else {
        x(c, "message", b), e = "postMessage" in c.parent ? c.parent : c.parent.document, e.postMessage(a.channel + "-ready", l), k(function() {
          f.up.callback(!0)
        }, 0)
      }
    }, init:function() {
      D(f.onDOMReady, f)
    }}
  };
  e.stack.FrameElementTransport = function(a) {
    var b, f, h, e;
    return b = {outgoing:function(a, b, c) {
      h.call(this, a);
      c && c()
    }, destroy:function() {
      f && (f.parentNode.removeChild(f), f = null)
    }, onDOMReady:function() {
      e = q(a.remote);
      a.isHost ? (r(a.props, {src:F(a.remote, {xdm_e:q(g.href), xdm_c:a.channel, xdm_p:5}), name:w + a.channel + "_provider"}), f = A(a), f.fn = function(a) {
        delete f.fn;
        h = a;
        k(function() {
          b.up.callback(!0)
        }, 0);
        return function(a) {
          b.up.incoming(a, e)
        }
      }) : (d.referrer && q(d.referrer) != u.xdm_e && (c.top.location = u.xdm_e), h = c.frameElement.fn(function(a) {
        b.up.incoming(a, e)
      }), b.up.callback(!0))
    }, init:function() {
      D(b.onDOMReady, b)
    }}
  };
  e.stack.NameTransport = function(a) {
    function b(b) {
      m.contentWindow.sendMessage(b, a.remoteHelper + (n ? "#_3" : "#_2") + a.channel)
    }
    function c() {
      n ? (2 === ++p || !n) && l.up.callback(!0) : (b("ready"), l.up.callback(!0))
    }
    function d(a) {
      l.up.incoming(a, J)
    }
    function g() {
      z && k(function() {
        z(!0)
      }, 0)
    }
    var l, n, m, t, p, z, J, Q;
    return l = {outgoing:function(a, c, f) {
      z = f;
      b(a)
    }, destroy:function() {
      m.parentNode.removeChild(m);
      m = null;
      n && (t.parentNode.removeChild(t), t = null)
    }, onDOMReady:function() {
      n = a.isHost;
      p = 0;
      J = q(a.remote);
      a.local = I(a.local);
      n ? (e.Fn.set(a.channel, function(b) {
        n && "ready" === b && (e.Fn.set(a.channel, d), c())
      }), Q = F(a.remote, {xdm_e:a.local, xdm_c:a.channel, xdm_p:2}), r(a.props, {src:Q + "#" + a.channel, name:w + a.channel + "_provider"}), t = A(a)) : (a.remoteHelper = a.remote, e.Fn.set(a.channel, d));
      var b = function() {
        var d = m || this;
        G(d, "load", b);
        e.Fn.set(a.channel + "_load", g);
        (function ga() {
          "function" == typeof d.contentWindow.sendMessage ? c() : k(ga, 50)
        })()
      };
      m = A({props:{src:a.local + "#_4" + a.channel}, onLoad:b})
    }, init:function() {
      D(l.onDOMReady, l)
    }}
  };
  e.stack.HashTransport = function(a) {
    function b() {
      if(t) {
        var a = t.location.href, b = "", c = a.indexOf("#");
        -1 != c && (b = a.substring(c));
        b && b != g && (g = b, f.up.incoming(g.substring(g.indexOf("_") + 1), J))
      }
    }
    var f, d, e, l, g, m, t, p, z, J;
    return f = {outgoing:function(b, c) {
      if(p) {
        var f = a.remote + "#" + m++ + "_" + b;
        (d || !z ? p.contentWindow : p).location = f
      }
    }, destroy:function() {
      c.clearInterval(e);
      (d || !z) && p.parentNode.removeChild(p);
      p = null
    }, onDOMReady:function() {
      d = a.isHost;
      l = a.interval;
      g = "#" + a.channel;
      m = 0;
      z = a.useParent;
      J = q(a.remote);
      if(d) {
        r(a.props, {src:a.remote, name:w + a.channel + "_provider"});
        if(z) {
          a.onLoad = function() {
            t = c;
            e = setInterval(b, l);
            f.up.callback(!0)
          }
        }else {
          var Q = 0, s = a.delay / 50;
          (function fa() {
            if(++Q > s) {
              throw Error("Unable to reference listenerwindow");
            }
            try {
              t = p.contentWindow.frames[w + a.channel + "_consumer"]
            }catch(c) {
            }
            t ? (e = setInterval(b, l), f.up.callback(!0)) : k(fa, 50)
          })()
        }
        p = A(a)
      }else {
        t = c, e = setInterval(b, l), z ? (p = parent, f.up.callback(!0)) : (r(a, {props:{src:a.remote + "#" + a.channel + new Date, name:w + a.channel + "_consumer"}, onLoad:function() {
          f.up.callback(!0)
        }}), p = A(a))
      }
    }, init:function() {
      D(f.onDOMReady, f)
    }}
  };
  e.stack.ReliableBehavior = function(a) {
    var b, c, d = 0, e = 0, g = "";
    return b = {incoming:function(a, m) {
      var k = a.indexOf("_"), p = a.substring(0, k).split(",");
      a = a.substring(k + 1);
      p[0] == d && (g = "", c && (c(!0), c = null));
      0 < a.length && (b.down.outgoing(p[1] + "," + d + "_" + g, m), e != p[1] && (e = p[1], b.up.incoming(a, m)))
    }, outgoing:function(a, m, k) {
      g = a;
      c = k;
      b.down.outgoing(e + "," + ++d + "_" + a, m)
    }}
  };
  e.stack.QueueBehavior = function(a) {
    function b() {
      if(a.remove && 0 === d.length) {
        da(c)
      }else {
        if(!e && !(0 === d.length || n)) {
          e = !0;
          var g = d.shift();
          c.down.outgoing(g.data, g.origin, function(a) {
            e = !1;
            g.callback && k(function() {
              g.callback(a)
            }, 0);
            b()
          })
        }
      }
    }
    var c, d = [], e = !0, g = "", n, m = 0, t = !1, p = !1;
    return c = {init:function() {
      y(a) && (a = {});
      a.maxLength && (m = a.maxLength, p = !0);
      a.lazy ? t = !0 : c.down.init()
    }, callback:function(a) {
      e = !1;
      var d = c.up;
      b();
      d.callback(a)
    }, incoming:function(b, d) {
      if(p) {
        var e = b.indexOf("_"), h = parseInt(b.substring(0, e), 10);
        g += b.substring(e + 1);
        0 === h && (a.encode && (g = s(g)), c.up.incoming(g, d), g = "")
      }else {
        c.up.incoming(b, d)
      }
    }, outgoing:function(g, e, l) {
      a.encode && (g = U(g));
      var k = [], n;
      if(p) {
        for(;0 !== g.length;) {
          n = g.substring(0, m), g = g.substring(n.length), k.push(n)
        }
        for(;n = k.shift();) {
          d.push({data:k.length + "_" + n, origin:e, callback:0 === k.length ? l : null})
        }
      }else {
        d.push({data:g, origin:e, callback:l})
      }
      t ? c.down.init() : b()
    }, destroy:function() {
      n = !0;
      c.down.destroy()
    }}
  };
  e.stack.VerifyBehavior = function(a) {
    function b() {
      d = Math.random().toString(16).substring(2);
      c.down.outgoing(d)
    }
    var c, d, g;
    return c = {incoming:function(e, k) {
      var m = e.indexOf("_");
      -1 === m ? e === d ? c.up.callback(!0) : g || (g = e, a.initiate || b(), c.down.outgoing(e)) : e.substring(0, m) === g && c.up.incoming(e.substring(m + 1), k)
    }, outgoing:function(a, b, g) {
      c.down.outgoing(d + "_" + a, b, g)
    }, callback:function(c) {
      a.initiate && b()
    }}
  };
  e.stack.RpcBehavior = function(a, b) {
    function c(a) {
      a.jsonrpc = "2.0";
      e.down.outgoing(k.stringify(a))
    }
    function d(a, b) {
      var g = Array.prototype.slice;
      return function() {
        var d = arguments.length, e, k = {method:b};
        0 < d && "function" === typeof arguments[d - 1] ? (1 < d && "function" === typeof arguments[d - 2] ? (e = {success:arguments[d - 2], error:arguments[d - 1]}, k.params = g.call(arguments, 0, d - 2)) : (e = {success:arguments[d - 1]}, k.params = g.call(arguments, 0, d - 1)), s["" + ++m] = e, k.id = m) : k.params = g.call(arguments, 0);
        a.namedParams && 1 === k.params.length && (k.params = k.params[0]);
        c(k)
      }
    }
    function g(a, b, d, e) {
      if(d) {
        var k, h;
        b ? (k = function(a) {
          k = S;
          c({id:b, result:a})
        }, h = function(a, d) {
          h = S;
          var e = {id:b, error:{code:-32099, message:a}};
          d && (e.error.data = d);
          c(e)
        }) : k = h = S;
        "[object Array]" !== Object.prototype.toString.call(e) && (e = [e]);
        try {
          var l = d.method.apply(d.scope, e.concat([k, h]));
          y(l) || k(l)
        }catch(m) {
          h(m.message)
        }
      }else {
        b && c({id:b, error:{code:-32601, message:"Procedure not found."}})
      }
    }
    var e, k = b.serializer || T(), m = 0, s = {};
    return e = {incoming:function(a, d) {
      var e = k.parse(a);
      if(e.method) {
        b.handle ? b.handle(e, c) : g(e.method, e.id, b.local[e.method], e.params)
      }else {
        var h = s[e.id];
        e.error ? h.error && h.error(e.error) : h.success && h.success(e.result);
        delete s[e.id]
      }
    }, init:function() {
      if(b.remote) {
        for(var c in b.remote) {
          b.remote.hasOwnProperty(c) && (a[c] = d(b.remote[c], c))
        }
      }
      e.down.init()
    }, destroy:function() {
      for(var c in b.remote) {
        b.remote.hasOwnProperty(c) && a.hasOwnProperty(c) && delete a[c]
      }
      e.down.destroy()
    }}
  };
  O.easyXDM = e
})(window, document, location, window.setTimeout, decodeURIComponent, encodeURIComponent);
var promise = function() {
};
promise.prototype = {pending:{resolve:function() {
}, reject:function() {
}}, then:function(c, d) {
  this.pending = {resolve:c, reject:d};
  return this
}, resolve:function(c) {
  this.pending.resolve(c)
}, reject:function(c) {
  this.pending.reject(c)
}};
try {
  addToNamespace("Promise", promise)
}catch(e$$13) {
  throw Error("Cannot extends 'Promise' to 'Adfab.playground.Promise'");
}
;var user = {env:{}, id:null, uid:null, data:{}, urls:{current:window.location.href, prev:null}, init:function() {
  PG.Util.GenerateUniqueId();
  PG.User.urls.prev = PG.Util.readCookie("prev-url");
  var c = PG.Util.readCookie("authent"), d = PG.Util.readCookie("last-sync"), g = (new Date).getTime();
  if(!PG.Util.not_null(d) || parseInt(d, 10) + 86400 < g) {
    c = null
  }
  PG.Util.not_null(c) ? (PG.User.data = JSON.parse(PG.Util.readCookie("authent")), PG.User.checkUser()) : PG.User.loadAuthent().then(function() {
    PG.User.checkUser()
  })
}, isLogged:function() {
  var c;
  if("" === PG.User.id || null === PG.User.id) {
    PG.User.id = PG.Util.readCookie("login")
  }
  c = PG.Util.not_null(PG.User.id) ? !0 : !1;
  PG.Util.log("isLogged : " + c);
  return c
}, loadAuthent:function() {
  var c = new PG.Promise;
  PG.App.call(PG.Config.env[PG.Config.mode].connect).then(function(d) {
    PG.User.data = d;
    PG.Util.createCookie("last-sync", (new Date).getTime());
    PG.Util.createCookie("authent", JSON.stringify(d));
    c.resolve()
  });
  return c
}, checkUser:function() {
  PG.User.isLogged() && PG.Util.not_null(PG.Util.readCookie("logout-try")) ? PG.Util.not_null(PG.User.data.library.stories.logout_user) && (PG.Util.not_null(PG.User.data.library.stories.logout_user.events.after) && PG.User.checkStory(PG.User.data.library.stories.logout_user.events.after)) && PG.User.logout() : !PG.User.isLogged() && PG.Util.not_null(PG.Util.readCookie("login-try")) ? PG.Util.not_null(PG.User.data.library.stories.login_user) && (PG.Util.not_null(PG.User.data.library.stories.login_user.events.after) && 
  PG.User.checkStory(PG.User.data.library.stories.login_user.events.after)) && PG.User.login(PG.Util.readCookie("login-try")) : !PG.User.isLogged() && PG.Util.not_null(PG.Util.readCookie("login")) ? PG.User.login(PG.Util.readCookie("login")) : PG.User.isLogged() && PG.User.logout();
  PG.Util.eraseCookie("logout-try");
  PG.Util.eraseCookie("login-try");
  PG.App.trackAreaEvent();
  PG.App.send(window.location.href)
}, login:function(c) {
  PG.Util.log('Login "' + c + '"');
  PG.Util.not_null(c) && (PG.User.id = c, PG.Util.createCookie("login", c));
  return PG.User.data.id
}, logout:function() {
  PG.Util.log("User is out");
  PG.Util.eraseCookie("login");
  PG.User.id = null
}, checkStory:function(c) {
  var d = !1;
  PG.Util.not_null(c) && (PG.Util.not_null(c.url) && PG.Util.not_null(c.xpath) && PG.Util.matchUrl(c.url) && PG.Util.checkXpath(c.xpath) ? d = !0 : PG.Util.not_null(c.url) && PG.Util.matchUrl(c.url) && !PG.Util.not_null(c.xpath) ? d = !0 : PG.Util.not_null(c.xpath) && (PG.Util.checkXpath(c.xpath) && !PG.Util.not_null(c.url)) && (d = !0));
  console.log("use : " + d);
  return d
}, getStory:function(c, d, g, k) {
  c = {user:{anonymous:PG.User.uid}, objects:{}, action:d, url:c, apiKey:PG.Settings.apiKey};
  PG.User.isLogged() && (c.user.login = PG.User.id);
  PG.Util.not_null(g) && (c.objects = {id:g.id}, PG.Util.not_null(g.properties) && (0 < g.properties.length && PG.Util.not_null(g.properties[0].xpath) && PG.Util.not_null(g.properties[0].name) && PG.Util.not_null(PG.Util.getObjectFromXpath(g.properties[0].xpath)[0])) && (c.objects.properties = {name:g.properties[0].name, value:PG.Util.getValueFromObject(PG.Util.getObjectFromXpath(g.properties[0].xpath)[0])}));
  return c
}, quit:function() {
  var c;
  PG.Util.createCookie("prev-url", window.location.href);
  PG.User.isLogged() ? PG.Util.not_null(PG.User.data.library.stories.logout_user) && PG.Util.not_null(PG.User.data.library.stories.logout_user.events.before) && PG.User.checkStory(PG.User.data.library.stories.logout_user.events.before) && (PG.User.getStory(window.location.href, "logout_user", PG.User.data.library.stories.logout_user.objects), PG.Util.createCookie("logout-try", "true")) : PG.Util.not_null(PG.User.data.library.stories.login_user) && PG.Util.not_null(PG.User.data.library.stories.login_user.events.before) && 
  PG.User.checkStory(PG.User.data.library.stories.login_user.events.before) && (c = PG.User.getStory(window.location.href, "login_user", PG.User.data.library.stories.login_user.objects), PG.Util.not_null(c.objects.properties.value) && PG.Util.createCookie("login-try", c.objects.properties.value))
}};
try {
  addToNamespace("User", user)
}catch(e$$14) {
  throw Error("Cannot extends 'User' to 'Adfab.playground.User'");
}
;function App() {
  return this
}
App.prototype.init = function() {
  PG.Util.not_null(PG.Settings) && PG.Util.not_null(PG.Settings.apiKey) ? (PG.Util.log("APIKEY FOUND \x3d " + PG.Settings.apiKey), PG.App.easyXDM(), PG.App.bindEvent(), PG.User.init(), PG.Util.fireEvt("earsReady", window, {apiKey:PG.Settings.apiKey, uid:PG.User.uid, login:PG.User.id})) : PG.Util.log("NO APIKEY FOUND")
};
App.prototype.bindEvent = function() {
  var c, d, g;
  c = PG.Cache.xmlhttp.prototype.open;
  d = PG.Cache.xmlhttp.prototype.send;
  PG.Cache.xmlhttp.prototype.open = function(d, s) {
    d || (d = "");
    s || (s = "");
    c.apply(this, arguments);
    g = d;
    "get" == d.toLowerCase() && s.split("?")
  };
  PG.Cache.xmlhttp.prototype.send = function(c, s) {
    c || (c = "");
    s || (s = "");
    d.apply(this, arguments);
    g.toLowerCase()
  };
  PG.Cache.document.onreadystatechange = function(c) {
    PG.Util.not_null(c.data)
  };
  PG.Cache.window.onbeforeunload = function(c) {
    PG.User.quit();
    return null
  }
};
App.prototype.trackAreaEvent = function() {
  function c(c, d) {
    c.addEventListener(d.event.type, function(c) {
      PG.Util.pointOnBox({x:c.pageX, y:c.pageY}, {x:d.event.area.x, y:d.event.area.y, width:d.event.area.width, height:d.event.area.height}) && PG.App.sendToEXDM({url:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + PG.Config.env[PG.Config.mode].send, method:"POST", data:PG.User.getStory(window.location.href, d.action, d.objects), headers:{"Content-Type":"application/json; charset\x3dutf-8"}})
    });
    if(PG.Config.debug) {
      var g = document.createElement("div");
      g.style.position = "absolute";
      g.style.left = d.event.area.x + "px";
      g.style.top = d.event.area.y + "px";
      g.style.width = d.event.area.width + "px";
      g.style.height = d.event.area.height + "px";
      g.style.backgroundColor = "rgba(255, 0, 0, .2)";
      document.body.appendChild(g)
    }
  }
  var d, g;
  for(d in PG.User.data.library.stories) {
    g = PG.User.data.library.stories[d], PG.User.checkStory(g.conditions) && PG.Util.not_null(g.event) && c(PG.Util.getObjectFromXpath(g.event.xpath)[0], g)
  }
};
App.prototype.easyXDM = function() {
  PG.App.rpc = new easyXDM.Rpc({local:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "easyXDM/name.html", swf:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "easyXDM/easyxdm.swf", remote:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "index.html"}, {remote:{request:{}}})
};
App.prototype.send = function(c) {
  var d = PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + PG.Config.env[PG.Config.mode].send, g, k;
  if(!PG.Util.isUrlValid(c)) {
    return!1
  }
  for(k in PG.User.data.library.stories) {
    g = PG.User.data.library.stories[k], PG.User.checkStory(g.conditions) && "undefined" === typeof g.event && (g = PG.User.getStory(c, g.action, g.objects), PG.App.sendToEXDM({url:d, method:"POST", data:g, headers:{"Content-Type":"application/json; charset\x3dutf-8"}}))
  }
  return!0
};
App.prototype.sendToEXDM = function(c) {
  PG.App.rpc.request(c, function(c) {
  }, function(c) {
    throw"Api Error, code : " + c.code + ", msg : " + c.message;
  })
};
App.prototype.call = function(c) {
  var d = new PG.Promise;
  PG.Util.log("call service : " + c);
  PG.App.rpc.request({url:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + c + "?apiKey\x3d" + PG.Settings.apiKey}, function(c) {
    d.resolve(JSON.parse(c.data))
  }, function(c) {
    throw"Api Error, code : " + c.code + ", msg : " + c.message;
  });
  return d
};
var app = new App;
try {
  addToNamespace("App", app)
}catch(e$$18) {
  throw Error("Cannot extends 'app' to 'Adfab.playground.App'");
}
app.init();
