(function(c, d, g, k, t, U) {
  function E(a, b) {
    var e = typeof a[b];
    return"function" == e || !!("object" == e && a[b]) || "unknown" == e
  }
  function V() {
    if(!y(navigator.plugins) && "object" == typeof navigator.plugins["Shockwave Flash"]) {
      var a = navigator.plugins["Shockwave Flash"].description;
      a && (!y(navigator.mimeTypes) && navigator.mimeTypes["application/x-shockwave-flash"] && navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin) && (B = a.match(/\d+/g))
    }
    if(!B) {
      var b;
      try {
        b = new ActiveXObject("ShockwaveFlash.ShockwaveFlash"), B = Array.prototype.slice.call(b.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/), 1)
      }catch(e) {
      }
    }
    if(!B) {
      return!1
    }
    a = parseInt(B[0], 10);
    b = parseInt(B[1], 10);
    R = 9 < a && 0 < b;
    return!0
  }
  function K() {
    if(!C) {
      C = !0;
      for(var a = 0;a < L.length;a++) {
        L[a]()
      }
      L.length = 0
    }
  }
  function D(a, b) {
    C ? a.call(b) : L.push(function() {
      a.call(b)
    })
  }
  function ba() {
    var a = parent;
    if("" !== H) {
      for(var b = 0, e = H.split(".");b < e.length;b++) {
        a = a[e[b]]
      }
    }
    return a.easyXDM
  }
  function r(a) {
    var b = a.toLowerCase().match(M);
    a = b[2];
    var e = b[3], b = b[4] || "";
    if("http:" == a && ":80" == b || "https:" == a && ":443" == b) {
      b = ""
    }
    return a + "//" + e + b
  }
  function I(a) {
    a = a.replace(ca, "$1/");
    if(!a.match(/^(http||https):\/\//)) {
      var b = "/" === a.substring(0, 1) ? "" : g.pathname;
      "/" !== b.substring(b.length - 1) && (b = b.substring(0, b.lastIndexOf("/") + 1));
      a = g.protocol + "//" + g.host + b + a
    }
    for(;W.test(a);) {
      a = a.replace(W, "")
    }
    return a
  }
  function F(a, b) {
    var e = "", l = a.indexOf("#");
    -1 !== l && (e = a.substring(l), a = a.substring(0, l));
    var l = [], c;
    for(c in b) {
      b.hasOwnProperty(c) && l.push(c + "\x3d" + U(b[c]))
    }
    return a + (X ? "#" : -1 == a.indexOf("?") ? "?" : "\x26") + l.join("\x26") + e
  }
  function y(a) {
    return"undefined" === typeof a
  }
  function s(a, b, e) {
    var l, c;
    for(c in b) {
      b.hasOwnProperty(c) && (c in a ? (l = b[c], "object" === typeof l ? s(a[c], l, e) : e || (a[c] = b[c])) : a[c] = b[c])
    }
    return a
  }
  function A(a) {
    if(y(N)) {
      var b = d.body.appendChild(d.createElement("form")), e = b.appendChild(d.createElement("input"));
      e.name = w + "TEST" + Y;
      N = e !== b.elements[e.name];
      d.body.removeChild(b)
    }
    N ? b = d.createElement('\x3ciframe name\x3d"' + a.props.name + '"/\x3e') : (b = d.createElement("IFRAME"), b.name = a.props.name);
    b.id = b.name = a.props.name;
    delete a.props.name;
    "string" == typeof a.container && (a.container = d.getElementById(a.container));
    a.container || (s(b.style, {position:"absolute", top:"-2000px", left:"0px"}), a.container = d.body);
    e = a.props.src;
    a.props.src = "javascript:false";
    s(b, a.props);
    b.border = b.frameBorder = 0;
    b.allowTransparency = !0;
    a.container.appendChild(b);
    a.onLoad && x(b, "load", a.onLoad);
    if(a.usePost) {
      var l = a.container.appendChild(d.createElement("form")), c;
      l.target = b.name;
      l.action = e;
      l.method = "POST";
      if("object" === typeof a.usePost) {
        for(var h in a.usePost) {
          a.usePost.hasOwnProperty(h) && (N ? c = d.createElement('\x3cinput name\x3d"' + h + '"/\x3e') : (c = d.createElement("INPUT"), c.name = h), c.value = a.usePost[h], l.appendChild(c))
        }
      }
      l.submit();
      l.parentNode.removeChild(l)
    }else {
      b.src = e
    }
    a.props.src = e;
    return b
  }
  function Z(a) {
    var b = a.protocol, e;
    a.isHost = a.isHost || y(u.xdm_p);
    X = a.hash || !1;
    a.props || (a.props = {});
    if(a.isHost) {
      a.remote = I(a.remote), a.channel = a.channel || "default" + Y++, a.secret = Math.random().toString(16).substring(2), y(b) && (b = r(g.href) == r(a.remote) ? "4" : E(c, "postMessage") || E(d, "postMessage") ? "1" : a.swf && E(c, "ActiveXObject") && V() ? "6" : "Gecko" === navigator.product && "frameElement" in c && -1 == navigator.userAgent.indexOf("WebKit") ? "5" : a.remoteHelper ? "2" : "0")
    }else {
      a.channel = u.xdm_c.replace(/["'<>\\]/g, "");
      a.secret = u.xdm_s;
      a.remote = u.xdm_e.replace(/["'<>\\]/g, "");
      var b = u.xdm_p, l;
      if(l = a.acl) {
        a: {
          l = a.acl;
          var v = a.remote;
          "string" == typeof l && (l = [l]);
          for(var h, m = l.length;m--;) {
            if(h = l[m], h = RegExp("^" == h.substr(0, 1) ? h : "^" + h.replace(/(\*)/g, ".$1").replace(/\?/g, ".") + "$"), h.test(v)) {
              l = !0;
              break a
            }
          }
          l = !1
        }
        l = !l
      }
      if(l) {
        throw Error("Access denied for " + a.remote);
      }
    }
    a.protocol = b;
    switch(b) {
      case "0":
        s(a, {interval:100, delay:2E3, useResize:!0, useParent:!1, usePolling:!1}, !0);
        if(a.isHost) {
          if(!a.local) {
            b = g.protocol + "//" + g.host;
            e = d.body.getElementsByTagName("img");
            for(v = e.length;v--;) {
              if(l = e[v], l.src.substring(0, b.length) === b) {
                a.local = l.src;
                break
              }
            }
            a.local || (a.local = c)
          }
          b = {xdm_c:a.channel, xdm_p:0};
          a.local === c ? (a.usePolling = !0, a.useParent = !0, a.local = g.protocol + "//" + g.host + g.pathname + g.search, b.xdm_e = a.local, b.xdm_pa = 1) : b.xdm_e = I(a.local);
          a.container && (a.useResize = !1, b.xdm_po = 1);
          a.remote = F(a.remote, b)
        }else {
          s(a, {channel:u.xdm_c, remote:u.xdm_e, useParent:!y(u.xdm_pa), usePolling:!y(u.xdm_po), useResize:a.useParent ? !1 : a.useResize})
        }
        e = [new f.stack.HashTransport(a), new f.stack.ReliableBehavior({}), new f.stack.QueueBehavior({encode:!0, maxLength:4E3 - a.remote.length}), new f.stack.VerifyBehavior({initiate:a.isHost})];
        break;
      case "1":
        e = [new f.stack.PostMessageTransport(a)];
        break;
      case "2":
        a.remoteHelper = I(a.remoteHelper);
        e = [new f.stack.NameTransport(a), new f.stack.QueueBehavior, new f.stack.VerifyBehavior({initiate:a.isHost})];
        break;
      case "3":
        e = [new f.stack.NixTransport(a)];
        break;
      case "4":
        e = [new f.stack.SameOriginTransport(a)];
        break;
      case "5":
        e = [new f.stack.FrameElementTransport(a)];
        break;
      case "6":
        B || V(), e = [new f.stack.FlashTransport(a)]
    }
    e.push(new f.stack.QueueBehavior({lazy:a.lazy, remove:!0}));
    return e
  }
  function $(a) {
    for(var b, e = {incoming:function(a, b) {
      this.up.incoming(a, b)
    }, outgoing:function(a, b) {
      this.down.outgoing(a, b)
    }, callback:function(a) {
      this.up.callback(a)
    }, init:function() {
      this.down.init()
    }, destroy:function() {
      this.down.destroy()
    }}, c = 0, d = a.length;c < d;c++) {
      b = a[c], s(b, e, !0), 0 !== c && (b.down = a[c - 1]), c !== d - 1 && (b.up = a[c + 1])
    }
    return b
  }
  function da(a) {
    a.up.down = a.down;
    a.down.up = a.up;
    a.up = a.down = null
  }
  var O = this, Y = Math.floor(1E4 * Math.random()), S = Function.prototype, M = /^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/, W = /[\-\w]+\/\.\.\//, ca = /([^:])\/\//g, H = "", f = {}, ea = c.easyXDM, w = "easyXDM_", N, X = !1, B, R, x, G;
  if(E(c, "addEventListener")) {
    x = function(a, b, e) {
      a.addEventListener(b, e, !1)
    }, G = function(a, b, e) {
      a.removeEventListener(b, e, !1)
    }
  }else {
    if(E(c, "attachEvent")) {
      x = function(a, b, e) {
        a.attachEvent("on" + b, e)
      }, G = function(a, b, e) {
        a.detachEvent("on" + b, e)
      }
    }else {
      throw Error("Browser not supported");
    }
  }
  var C = !1, L = [], P;
  "readyState" in d ? (P = d.readyState, C = "complete" == P || ~navigator.userAgent.indexOf("AppleWebKit/") && ("loaded" == P || "interactive" == P)) : C = !!d.body;
  if(!C) {
    if(E(c, "addEventListener")) {
      x(d, "DOMContentLoaded", K)
    }else {
      if(x(d, "readystatechange", function() {
        "complete" == d.readyState && K()
      }), d.documentElement.doScroll && c === top) {
        var aa = function() {
          if(!C) {
            try {
              d.documentElement.doScroll("left")
            }catch(a) {
              k(aa, 1);
              return
            }
            K()
          }
        };
        aa()
      }
    }
    x(c, "load", K)
  }
  var u = function(a) {
    a = a.substring(1).split("\x26");
    for(var b = {}, e, c = a.length;c--;) {
      e = a[c].split("\x3d"), b[e[0]] = t(e[1])
    }
    return b
  }(/xdm_e=/.test(g.search) ? g.search : g.hash), T = function() {
    var a = {}, b = {a:[1, 2, 3]};
    if("undefined" != typeof JSON && "function" === typeof JSON.stringify && '{"a":[1,2,3]}' === JSON.stringify(b).replace(/\s/g, "")) {
      return JSON
    }
    Object.toJSON && '{"a":[1,2,3]}' === Object.toJSON(b).replace(/\s/g, "") && (a.stringify = Object.toJSON);
    "function" === typeof String.prototype.evalJSON && (b = '{"a":[1,2,3]}'.evalJSON(), b.a && (3 === b.a.length && 3 === b.a[2]) && (a.parse = function(a) {
      return a.evalJSON()
    }));
    return a.stringify && a.parse ? (T = function() {
      return a
    }, a) : null
  };
  s(f, {version:"2.4.17.1", query:u, stack:{}, apply:s, getJSONObject:T, whenReady:D, noConflict:function(a) {
    c.easyXDM = ea;
    (H = a) && (w = "easyXDM_" + H.replace(".", "_") + "_");
    return f
  }});
  f.DomHelper = {on:x, un:G, requiresJSON:function(a) {
    "object" == typeof c.JSON && c.JSON || d.write('\x3cscript type\x3d"text/javascript" src\x3d"' + a + '"\x3e\x3c/script\x3e')
  }};
  (function() {
    var a = {};
    f.Fn = {set:function(b, e) {
      a[b] = e
    }, get:function(b, e) {
      var c = a[b];
      e && delete a[b];
      return c
    }}
  })();
  f.Socket = function(a) {
    var b = $(Z(a).concat([{incoming:function(b, e) {
      a.onMessage(b, e)
    }, callback:function(b) {
      if(a.onReady) {
        a.onReady(b)
      }
    }}])), e = r(a.remote);
    this.origin = r(a.remote);
    this.destroy = function() {
      b.destroy()
    };
    this.postMessage = function(a) {
      b.outgoing(a, e)
    };
    b.init()
  };
  f.Rpc = function(a, b) {
    if(b.local) {
      for(var e in b.local) {
        if(b.local.hasOwnProperty(e)) {
          var c = b.local[e];
          "function" === typeof c && (b.local[e] = {method:c})
        }
      }
    }
    var d = $(Z(a).concat([new f.stack.RpcBehavior(this, b), {callback:function(b) {
      if(a.onReady) {
        a.onReady(b)
      }
    }}]));
    this.origin = r(a.remote);
    this.destroy = function() {
      d.destroy()
    };
    d.init()
  };
  f.stack.SameOriginTransport = function(a) {
    var b, e, c, d;
    return b = {outgoing:function(a, b, e) {
      c(a);
      e && e()
    }, destroy:function() {
      e && (e.parentNode.removeChild(e), e = null)
    }, onDOMReady:function() {
      d = r(a.remote);
      a.isHost ? (s(a.props, {src:F(a.remote, {xdm_e:g.protocol + "//" + g.host + g.pathname, xdm_c:a.channel, xdm_p:4}), name:w + a.channel + "_provider"}), e = A(a), f.Fn.set(a.channel, function(a) {
        c = a;
        k(function() {
          b.up.callback(!0)
        }, 0);
        return function(a) {
          b.up.incoming(a, d)
        }
      })) : (c = ba().Fn.get(a.channel, !0)(function(a) {
        b.up.incoming(a, d)
      }), k(function() {
        b.up.callback(!0)
      }, 0))
    }, init:function() {
      D(b.onDOMReady, b)
    }}
  };
  f.stack.FlashTransport = function(a) {
    function b(a, b) {
      k(function() {
        c.up.incoming(a, h)
      }, 0)
    }
    function e(b) {
      var c = a.swf + "?host\x3d" + a.isHost, e = "easyXDM_swf_" + Math.floor(1E4 * Math.random());
      f.Fn.set("flash_loaded" + b.replace(/[\-.]/g, "_"), function() {
        f.stack.FlashTransport[b].swf = m = n.firstChild;
        for(var a = f.stack.FlashTransport[b].queue, c = 0;c < a.length;c++) {
          a[c]()
        }
        a.length = 0
      });
      a.swfContainer ? n = "string" == typeof a.swfContainer ? d.getElementById(a.swfContainer) : a.swfContainer : (n = d.createElement("div"), s(n.style, R && a.swfNoThrottle ? {height:"20px", width:"20px", position:"fixed", right:0, top:0} : {height:"1px", width:"1px", position:"absolute", overflow:"hidden", right:0, top:0}), d.body.appendChild(n));
      var l = "callback\x3dflash_loaded" + b.replace(/[\-.]/g, "_") + "\x26proto\x3d" + O.location.protocol + "\x26domain\x3d" + O.location.href.match(M)[3] + "\x26port\x3d" + (O.location.href.match(M)[4] || "") + "\x26ns\x3d" + H;
      n.innerHTML = "\x3cobject height\x3d'20' width\x3d'20' type\x3d'application/x-shockwave-flash' id\x3d'" + e + "' data\x3d'" + c + "'\x3e\x3cparam name\x3d'allowScriptAccess' value\x3d'always'\x3e\x3c/param\x3e\x3cparam name\x3d'wmode' value\x3d'transparent'\x3e\x3cparam name\x3d'movie' value\x3d'" + c + "'\x3e\x3c/param\x3e\x3cparam name\x3d'flashvars' value\x3d'" + l + "'\x3e\x3c/param\x3e\x3cembed type\x3d'application/x-shockwave-flash' FlashVars\x3d'" + l + "' allowScriptAccess\x3d'always' wmode\x3d'transparent' src\x3d'" + 
      c + "' height\x3d'1' width\x3d'1'\x3e\x3c/embed\x3e\x3c/object\x3e"
    }
    var c, v, h, m, n;
    return c = {outgoing:function(b, c, e) {
      m.postMessage(a.channel, b.toString());
      e && e()
    }, destroy:function() {
      try {
        m.destroyChannel(a.channel)
      }catch(b) {
      }
      m = null;
      v && (v.parentNode.removeChild(v), v = null)
    }, onDOMReady:function() {
      h = a.remote;
      f.Fn.set("flash_" + a.channel + "_init", function() {
        k(function() {
          c.up.callback(!0)
        })
      });
      f.Fn.set("flash_" + a.channel + "_onMessage", b);
      a.swf = I(a.swf);
      var d = a.swf.match(M)[3], n = function() {
        f.stack.FlashTransport[d].init = !0;
        m = f.stack.FlashTransport[d].swf;
        m.createChannel(a.channel, a.secret, r(a.remote), a.isHost);
        a.isHost && (R && a.swfNoThrottle && s(a.props, {position:"fixed", right:0, top:0, height:"20px", width:"20px"}), s(a.props, {src:F(a.remote, {xdm_e:r(g.href), xdm_c:a.channel, xdm_p:6, xdm_s:a.secret}), name:w + a.channel + "_provider"}), v = A(a))
      };
      f.stack.FlashTransport[d] && f.stack.FlashTransport[d].init ? n() : f.stack.FlashTransport[d] ? f.stack.FlashTransport[d].queue.push(n) : (f.stack.FlashTransport[d] = {queue:[n]}, e(d))
    }, init:function() {
      D(c.onDOMReady, c)
    }}
  };
  f.stack.PostMessageTransport = function(a) {
    function b(b) {
      var c;
      if(b.origin) {
        c = r(b.origin)
      }else {
        if(b.uri) {
          c = r(b.uri)
        }else {
          if(b.domain) {
            c = g.protocol + "//" + b.domain
          }else {
            throw"Unable to retrieve the origin of the event";
          }
        }
      }
      c == h && b.data.substring(0, a.channel.length + 1) == a.channel + " " && e.up.incoming(b.data.substring(a.channel.length + 1), c)
    }
    var e, d, f, h;
    return e = {outgoing:function(b, c, e) {
      f.postMessage(a.channel + " " + b, c || h);
      e && e()
    }, destroy:function() {
      G(c, "message", b);
      d && (f = null, d.parentNode.removeChild(d), d = null)
    }, onDOMReady:function() {
      h = r(a.remote);
      if(a.isHost) {
        var m = function(h) {
          h.data == a.channel + "-ready" && (f = "postMessage" in d.contentWindow ? d.contentWindow : d.contentWindow.document, G(c, "message", m), x(c, "message", b), k(function() {
            e.up.callback(!0)
          }, 0))
        };
        x(c, "message", m);
        s(a.props, {src:F(a.remote, {xdm_e:r(g.href), xdm_c:a.channel, xdm_p:1}), name:w + a.channel + "_provider"});
        d = A(a)
      }else {
        x(c, "message", b), f = "postMessage" in c.parent ? c.parent : c.parent.document, f.postMessage(a.channel + "-ready", h), k(function() {
          e.up.callback(!0)
        }, 0)
      }
    }, init:function() {
      D(e.onDOMReady, e)
    }}
  };
  f.stack.FrameElementTransport = function(a) {
    var b, e, l, f;
    return b = {outgoing:function(a, b, c) {
      l.call(this, a);
      c && c()
    }, destroy:function() {
      e && (e.parentNode.removeChild(e), e = null)
    }, onDOMReady:function() {
      f = r(a.remote);
      a.isHost ? (s(a.props, {src:F(a.remote, {xdm_e:r(g.href), xdm_c:a.channel, xdm_p:5}), name:w + a.channel + "_provider"}), e = A(a), e.fn = function(a) {
        delete e.fn;
        l = a;
        k(function() {
          b.up.callback(!0)
        }, 0);
        return function(a) {
          b.up.incoming(a, f)
        }
      }) : (d.referrer && r(d.referrer) != u.xdm_e && (c.top.location = u.xdm_e), l = c.frameElement.fn(function(a) {
        b.up.incoming(a, f)
      }), b.up.callback(!0))
    }, init:function() {
      D(b.onDOMReady, b)
    }}
  };
  f.stack.NameTransport = function(a) {
    function b(b) {
      n.contentWindow.sendMessage(b, a.remoteHelper + (m ? "#_3" : "#_2") + a.channel)
    }
    function c() {
      m ? (2 === ++p || !m) && h.up.callback(!0) : (b("ready"), h.up.callback(!0))
    }
    function d(a) {
      h.up.incoming(a, J)
    }
    function g() {
      z && k(function() {
        z(!0)
      }, 0)
    }
    var h, m, n, q, p, z, J, Q;
    return h = {outgoing:function(a, c, e) {
      z = e;
      b(a)
    }, destroy:function() {
      n.parentNode.removeChild(n);
      n = null;
      m && (q.parentNode.removeChild(q), q = null)
    }, onDOMReady:function() {
      m = a.isHost;
      p = 0;
      J = r(a.remote);
      a.local = I(a.local);
      m ? (f.Fn.set(a.channel, function(b) {
        m && "ready" === b && (f.Fn.set(a.channel, d), c())
      }), Q = F(a.remote, {xdm_e:a.local, xdm_c:a.channel, xdm_p:2}), s(a.props, {src:Q + "#" + a.channel, name:w + a.channel + "_provider"}), q = A(a)) : (a.remoteHelper = a.remote, f.Fn.set(a.channel, d));
      var b = function() {
        var d = n || this;
        G(d, "load", b);
        f.Fn.set(a.channel + "_load", g);
        (function ha() {
          "function" == typeof d.contentWindow.sendMessage ? c() : k(ha, 50)
        })()
      };
      n = A({props:{src:a.local + "#_4" + a.channel}, onLoad:b})
    }, init:function() {
      D(h.onDOMReady, h)
    }}
  };
  f.stack.HashTransport = function(a) {
    function b() {
      if(q) {
        var a = q.location.href, b = "", c = a.indexOf("#");
        -1 != c && (b = a.substring(c));
        b && b != g && (g = b, e.up.incoming(g.substring(g.indexOf("_") + 1), J))
      }
    }
    var e, d, f, h, g, n, q, p, z, J;
    return e = {outgoing:function(b, c) {
      if(p) {
        var e = a.remote + "#" + n++ + "_" + b;
        (d || !z ? p.contentWindow : p).location = e
      }
    }, destroy:function() {
      c.clearInterval(f);
      (d || !z) && p.parentNode.removeChild(p);
      p = null
    }, onDOMReady:function() {
      d = a.isHost;
      h = a.interval;
      g = "#" + a.channel;
      n = 0;
      z = a.useParent;
      J = r(a.remote);
      if(d) {
        s(a.props, {src:a.remote, name:w + a.channel + "_provider"});
        if(z) {
          a.onLoad = function() {
            q = c;
            f = setInterval(b, h);
            e.up.callback(!0)
          }
        }else {
          var Q = 0, fa = a.delay / 50;
          (function ga() {
            if(++Q > fa) {
              throw Error("Unable to reference listenerwindow");
            }
            try {
              q = p.contentWindow.frames[w + a.channel + "_consumer"]
            }catch(c) {
            }
            q ? (f = setInterval(b, h), e.up.callback(!0)) : k(ga, 50)
          })()
        }
        p = A(a)
      }else {
        q = c, f = setInterval(b, h), z ? (p = parent, e.up.callback(!0)) : (s(a, {props:{src:a.remote + "#" + a.channel + new Date, name:w + a.channel + "_consumer"}, onLoad:function() {
          e.up.callback(!0)
        }}), p = A(a))
      }
    }, init:function() {
      D(e.onDOMReady, e)
    }}
  };
  f.stack.ReliableBehavior = function(a) {
    var b, c, d = 0, f = 0, h = "";
    return b = {incoming:function(a, g) {
      var k = a.indexOf("_"), p = a.substring(0, k).split(",");
      a = a.substring(k + 1);
      p[0] == d && (h = "", c && (c(!0), c = null));
      0 < a.length && (b.down.outgoing(p[1] + "," + d + "_" + h, g), f != p[1] && (f = p[1], b.up.incoming(a, g)))
    }, outgoing:function(a, g, k) {
      h = a;
      c = k;
      b.down.outgoing(f + "," + ++d + "_" + a, g)
    }}
  };
  f.stack.QueueBehavior = function(a) {
    function b() {
      if(a.remove && 0 === d.length) {
        da(c)
      }else {
        if(!f && !(0 === d.length || g)) {
          f = !0;
          var h = d.shift();
          c.down.outgoing(h.data, h.origin, function(a) {
            f = !1;
            h.callback && k(function() {
              h.callback(a)
            }, 0);
            b()
          })
        }
      }
    }
    var c, d = [], f = !0, h = "", g, n = 0, q = !1, p = !1;
    return c = {init:function() {
      y(a) && (a = {});
      a.maxLength && (n = a.maxLength, p = !0);
      a.lazy ? q = !0 : c.down.init()
    }, callback:function(a) {
      f = !1;
      var d = c.up;
      b();
      d.callback(a)
    }, incoming:function(b, d) {
      if(p) {
        var f = b.indexOf("_"), g = parseInt(b.substring(0, f), 10);
        h += b.substring(f + 1);
        0 === g && (a.encode && (h = t(h)), c.up.incoming(h, d), h = "")
      }else {
        c.up.incoming(b, d)
      }
    }, outgoing:function(f, h, g) {
      a.encode && (f = U(f));
      var k = [], m;
      if(p) {
        for(;0 !== f.length;) {
          m = f.substring(0, n), f = f.substring(m.length), k.push(m)
        }
        for(;m = k.shift();) {
          d.push({data:k.length + "_" + m, origin:h, callback:0 === k.length ? g : null})
        }
      }else {
        d.push({data:f, origin:h, callback:g})
      }
      q ? c.down.init() : b()
    }, destroy:function() {
      g = !0;
      c.down.destroy()
    }}
  };
  f.stack.VerifyBehavior = function(a) {
    function b() {
      d = Math.random().toString(16).substring(2);
      c.down.outgoing(d)
    }
    var c, d, f;
    return c = {incoming:function(h, g) {
      var k = h.indexOf("_");
      -1 === k ? h === d ? c.up.callback(!0) : f || (f = h, a.initiate || b(), c.down.outgoing(h)) : h.substring(0, k) === f && c.up.incoming(h.substring(k + 1), g)
    }, outgoing:function(a, b, f) {
      c.down.outgoing(d + "_" + a, b, f)
    }, callback:function(c) {
      a.initiate && b()
    }}
  };
  f.stack.RpcBehavior = function(a, b) {
    function c(a) {
      a.jsonrpc = "2.0";
      g.down.outgoing(k.stringify(a))
    }
    function d(a, b) {
      var f = Array.prototype.slice;
      return function() {
        var d = arguments.length, g, h = {method:b};
        0 < d && "function" === typeof arguments[d - 1] ? (1 < d && "function" === typeof arguments[d - 2] ? (g = {success:arguments[d - 2], error:arguments[d - 1]}, h.params = f.call(arguments, 0, d - 2)) : (g = {success:arguments[d - 1]}, h.params = f.call(arguments, 0, d - 1)), q["" + ++n] = g, h.id = n) : h.params = f.call(arguments, 0);
        a.namedParams && 1 === h.params.length && (h.params = h.params[0]);
        c(h)
      }
    }
    function f(a, b, d, g) {
      if(d) {
        var h, k;
        b ? (h = function(a) {
          h = S;
          c({id:b, result:a})
        }, k = function(a, d) {
          k = S;
          var f = {id:b, error:{code:-32099, message:a}};
          d && (f.error.data = d);
          c(f)
        }) : h = k = S;
        "[object Array]" !== Object.prototype.toString.call(g) && (g = [g]);
        try {
          var l = d.method.apply(d.scope, g.concat([h, k]));
          y(l) || h(l)
        }catch(m) {
          k(m.message)
        }
      }else {
        b && c({id:b, error:{code:-32601, message:"Procedure not found."}})
      }
    }
    var g, k = b.serializer || T(), n = 0, q = {};
    return g = {incoming:function(a, d) {
      var g = k.parse(a);
      if(g.method) {
        b.handle ? b.handle(g, c) : f(g.method, g.id, b.local[g.method], g.params)
      }else {
        var h = q[g.id];
        g.error ? h.error && h.error(g.error) : h.success && h.success(g.result);
        delete q[g.id]
      }
    }, init:function() {
      if(b.remote) {
        for(var c in b.remote) {
          b.remote.hasOwnProperty(c) && (a[c] = d(b.remote[c], c))
        }
      }
      g.down.init()
    }, destroy:function() {
      for(var c in b.remote) {
        b.remote.hasOwnProperty(c) && a.hasOwnProperty(c) && delete a[c]
      }
      g.down.destroy()
    }}
  };
  O.easyXDM = f
})(window, document, location, window.setTimeout, decodeURIComponent, encodeURIComponent);
var promise = function() {
};
promise.prototype = {pending:{resolve:function() {
}, reject:function() {
}}, then:function(c, d) {
  this.pending = {resolve:c, reject:d};
  return this
}, resolve:function(c) {
  this.pending.resolve(c)
}, reject:function(c) {
  this.pending.reject(c)
}};
try {
  addToNamespace("Promise", promise)
}catch(e$$13) {
  throw Error("Cannot extends 'Promise' to 'Adfab.playground.Promise'");
}
;var user = {env:{}, id:null, uid:null, data:{}, urls:{current:top.location.href, prev:null}, init:function() {
  PG.Util.GenerateUniqueId();
  PG.User.urls.prev = PG.Util.readCookie("prev-url");
  var c = PG.Util.readCookie("authent"), d = PG.Util.readCookie("last-sync"), g = (new Date).getTime();
  if(!PG.Util.not_null(d) || parseInt(d) + 86400 < g) {
    c = null
  }
  PG.Util.not_null(c) ? (PG.User.data = JSON.parse(PG.Util.readCookie("authent")), PG.User.checkUser()) : PG.User.loadAuthent().then(function() {
    PG.User.checkUser()
  })
}, isLogged:function() {
  var c;
  if("" === PG.User.id || null === PG.User.id) {
    PG.User.id = PG.Util.readCookie("login")
  }
  c = PG.Util.not_null(PG.User.id) ? !0 : !1;
  PG.Util.log("isLogged : " + c);
  return c
}, loadAuthent:function() {
  var c = new PG.Promise;
  PG.App.call(PG.Config.env[PG.Config.mode].connect).then(function(d) {
    PG.User.data = d;
    PG.Util.createCookie("last-sync", (new Date).getTime());
    PG.Util.createCookie("authent", JSON.stringify(d));
    c.resolve()
  });
  return c
}, checkUser:function() {
  PG.Util.not_null(PG.Util.readCookie("logout-try")) ? PG.Util.not_null(PG.User.data.library.stories.logout_user) && (PG.Util.not_null(PG.User.data.library.stories.logout_user.events.after) && PG.User.checkStory(PG.User.data.library.stories.logout_user.events.after)) && PG.User.logout() : PG.Util.not_null(PG.Util.readCookie("login-try")) && PG.Util.not_null(PG.User.data.library.stories.login_user) && (PG.Util.not_null(PG.User.data.library.stories.login_user.events.after) && PG.User.checkStory(PG.User.data.library.stories.login_user.events.after)) && 
  PG.User.login(PG.Util.readCookie("login-try"));
  PG.Util.not_null(PG.Util.readCookie("login")) ? PG.User.login(PG.Util.readCookie("login")) : PG.User.logout()
}, login:function(c) {
  PG.Util.eraseCookie("logout-try");
  PG.Util.log('Login "' + c + '"');
  PG.Util.not_null(c) && (PG.Util.eraseCookie("login-try"), PG.User.id = c, PG.Util.createCookie("login", c), PG.App.send(top.location.href));
  return PG.User.data.id
}, logout:function() {
  PG.Util.log("User is out");
  PG.Util.eraseCookie("logout-try");
  PG.Util.eraseCookie("login-try");
  PG.Util.eraseCookie("login");
  PG.User.id = null;
  PG.App.send(top.location.href)
}, checkEvidences:function(c) {
  var d = null, g = !0, k;
  for(k in c) {
    "id" === c[k].selector ? d = document.getElementById(c[k].name) : "class" === PG.User.data.evidences[k].selector && (d = document.getElementsByClassName(c[k].name)), null === d && (g = !1)
  }
  return g
}, checkStory:function(c) {
  var d = !1;
  PG.Util.not_null(c) && PG.Util.not_null(c) && (PG.Util.not_null(c.url) && PG.Util.not_null(c.xpath) && PG.Util.matchUrl(c.url) && PG.Util.checkXpath(c.xpath) ? d = !0 : PG.Util.not_null(c.url) && PG.Util.matchUrl(c.url) && !PG.Util.not_null(c.xpath) ? d = !0 : PG.Util.not_null(c.xpath) && (PG.Util.checkXpath(c.xpath) && !PG.Util.not_null(c.url)) && (d = !0));
  return d
}, getStory:function(c, d) {
  var g = {name:c, properties:[]}, k, t;
  if(PG.Util.not_null(d)) {
    for(t in d.properties) {
      k = d.properties[t], PG.Util.not_null(k) && "function" !== typeof k && PG.Util.not_null(PG.Util.getObjectFromXpath(k.xpath)[0]) && g.properties.push({name:k.name, value:PG.Util.getValueFromObject(PG.Util.getObjectFromXpath(k.xpath)[0])})
    }
  }
  return g
}, quit:function() {
  var c;
  PG.Util.createCookie("prev-url", top.location.href);
  PG.User.isLogged() ? PG.Util.not_null(PG.User.data.library.stories.logout_user) && PG.Util.not_null(PG.User.data.library.stories.logout_user.events.before) && PG.User.checkStory(PG.User.data.library.stories.logout_user.events.before) && (c = PG.User.getStory(PG.User.data.library.stories.logout_user.action, PG.User.data.library.stories.logout_user.objects), PG.Util.createCookie("logout-try", JSON.stringify(c))) : PG.Util.not_null(PG.User.data.library.stories.login_user) && PG.Util.not_null(PG.User.data.library.stories.login_user.events.before) && 
  PG.User.checkStory(PG.User.data.library.stories.login_user.events.before) && (c = PG.User.getStory(PG.User.data.library.stories.login_user.action, PG.User.data.library.stories.login_user.objects), PG.Util.createCookie("login-try", JSON.stringify(c)))
}};
try {
  addToNamespace("User", user)
}catch(e$$14) {
  throw Error("Cannot extends 'User' to 'Adfab.playground.User'");
}
;function App() {
  return this
}
App.prototype.init = function() {
  PG.Util.not_null(PG.Settings) && PG.Util.not_null(PG.Settings.apiKey) ? (PG.Util.log("APIKEY FOUND \x3d " + PG.Settings.apiKey), PG.App.easyXDM(), PG.App.bindEvent(), PG.User.init(), PG.Util.fireEvt("earsReady", window, {apiKey:PG.Settings.apiKey, uid:PG.User.uid, login:PG.User.id})) : PG.Util.log("NO APIKEY FOUND")
};
App.prototype.bindEvent = function() {
  var c, d, g;
  c = PG.Cache.xmlhttp.prototype.open;
  d = PG.Cache.xmlhttp.prototype.send;
  PG.Cache.xmlhttp.prototype.open = function(d, t) {
    d || (d = "");
    t || (t = "");
    c.apply(this, arguments);
    g = d;
    "get" == d.toLowerCase() && t.split("?")
  };
  PG.Cache.xmlhttp.prototype.send = function(c, t) {
    c || (c = "");
    t || (t = "");
    d.apply(this, arguments);
    g.toLowerCase()
  };
  PG.Cache.document.onreadystatechange = function(c) {
    PG.Util.not_null(c.data)
  };
  PG.Cache.window.onbeforeunload = function(c) {
    PG.User.quit();
    return null
  }
};
App.prototype.easyXDM = function() {
  PG.App.rpc = new easyXDM.Rpc({local:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "easyXDM/name.html", swf:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "easyXDM/easyxdm.swf", remote:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + "index.html"}, {remote:{request:{}}})
};
App.prototype.send = function(c) {
  var d = PG.User.data.library.config.broadcast, g = {user:{uid:PG.User.uid}, actions:[], url:c, apiKey:PG.Settings.apiKey}, k;
  if(!PG.Util.isUrlValid(c)) {
    return!1
  }
  for(k in PG.User.data.library.stories) {
    c = PG.User.data.library.stories[k], PG.User.checkStory(c.conditions) && g.actions.push(PG.User.getStory(c.action, c.objects))
  }
  if(d || 0 < g.actions.length) {
    PG.User.isLogged() && (g.user.login = PG.User.id), g.actions = JSON.stringify(g.actions), g.user = JSON.stringify(g.user), d = PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + PG.Config.env[PG.Config.mode].send, PG.App.rpc.request({url:d, method:"POST", data:g}, function(c) {
      PG.Util.log(c)
    }, function(c) {
      throw"Api Error, code : " + c.code + ", msg : " + c.message;
    })
  }
  return!0
};
App.prototype.call = function(c) {
  var d = new PG.Promise;
  PG.Util.log("call service : " + c);
  PG.App.rpc.request({url:PG.Cache.protocol + PG.Config.env[PG.Config.mode].url + c + "?apiKey\x3d" + PG.Settings.apiKey}, function(c) {
    d.resolve(JSON.parse(c.data))
  }, function(c) {
    throw"Api Error, code : " + c.code + ", msg : " + c.message;
  });
  return d
};
var app = new App;
try {
  addToNamespace("App", app)
}catch(e$$17) {
  throw Error("Cannot extends 'app' to 'Adfab.playground.App'");
}
app.init();
